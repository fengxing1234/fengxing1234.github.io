<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="en">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT" />










<meta name="description" content="人生就像是一个马尔可夫链，你的未来取决于你当下正在做的事，而无关于过去做完的事">
<meta property="og:type" content="website">
<meta property="og:title" content="冯星的博客">
<meta property="og:url" content="http://yoursite.com/page/2/index.html">
<meta property="og:site_name" content="冯星的博客">
<meta property="og:description" content="人生就像是一个马尔可夫链，你的未来取决于你当下正在做的事，而无关于过去做完的事">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="冯星">
<meta property="article:tag" content="Java，Android，Flutter">
<meta name="twitter:card" content="summary">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/page/2/"/>





  <title>冯星的博客</title>
  








<meta name="generator" content="Hexo 4.2.0"></head>

<body itemscope itemtype="http://schema.org/WebPage" lang="en">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">冯星的博客</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">Life is like a Markov chain, your future only depends on what you are doing now, and independent of your past.</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            About
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            Tags
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            Categories
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            Archives
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/06/06/Java/%E5%9F%BA%E7%A1%80/Java%E6%B3%A8%E8%A7%A3-Annotation/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="冯星">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="冯星的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/06/06/Java/%E5%9F%BA%E7%A1%80/Java%E6%B3%A8%E8%A7%A3-Annotation/" itemprop="url">Java注解-Annotation</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-06-06T11:26:45+08:00">
                2020-06-06
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2020/06/06/Java/%E5%9F%BA%E7%A1%80/Java%E6%B3%A8%E8%A7%A3-Annotation/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count valine-comment-count" data-xid="/2020/06/06/Java/%E5%9F%BA%E7%A1%80/Java%E6%B3%A8%E8%A7%A3-Annotation/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="一、什么是注解"><a href="#一、什么是注解" class="headerlink" title="一、什么是注解"></a>一、什么是注解</h2><p>注解（Annotation），也叫元数据，一种代码级别的说明。JDK1.5引入的特性，与类、接口、枚举是在同一个层次，它可以声明在包、类、字段、方法、局部变量、方法参数等的前面，用来对这些元素进行说明，注释。<strong>注解的本质就是一个继承了 Annotation 接口的接口</strong>，所有的注解类型都继承自Annotation。</p>
<h2 id="二、元注解"><a href="#二、元注解" class="headerlink" title="二、元注解"></a>二、元注解</h2><p>元注解的作用就是负责注解其他注解。Java5.0定义了4个标准的meta-annotation类型，它们被用来提供对其它 annotation类型作说明。Java5.0定义的元注解：</p>
<h3 id="Target："><a href="#Target：" class="headerlink" title="@Target："></a>@Target：</h3><p><strong>用于描述注解的使用范围（即：被描述的注解可以用在什么地方）</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">@Documented</span><br><span class="line">@Retention(RetentionPolicy.RUNTIME)</span><br><span class="line">@Target(ElementType.ANNOTATION_TYPE)</span><br><span class="line">public @interface Target &#123;</span><br><span class="line">    ElementType[] value();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>@Target：表示该注解类型的所使用的程序元素类型。当注解类型声明中没有@Target元注解，则默认为可适用所有的程序元素。如果存在指定的@Target元注解，则编译器强制实施相应的使用限制。关于程序元素(ElementType)是枚举类型，共定义8种程序元素，如下表：</p>
<table>
<thead>
<tr>
<th align="left">ElementType</th>
<th align="left">含义</th>
</tr>
</thead>
<tbody><tr>
<td align="left">ANNOTATION_TYPE</td>
<td align="left">注解类型声明</td>
</tr>
<tr>
<td align="left">CONSTRUCTOR</td>
<td align="left">构造方法声明</td>
</tr>
<tr>
<td align="left">FIELD</td>
<td align="left">字段声明（包括枚举常量）</td>
</tr>
<tr>
<td align="left">LOCAL_VARIABLE</td>
<td align="left">局部变量声明</td>
</tr>
<tr>
<td align="left">METHOD</td>
<td align="left">方法声明</td>
</tr>
<tr>
<td align="left">PACKAGE</td>
<td align="left">包声明</td>
</tr>
<tr>
<td align="left">PARAMETER</td>
<td align="left">参数声明</td>
</tr>
<tr>
<td align="left">TYPE</td>
<td align="left">类、接口（包括注解类型）或枚举声明</td>
</tr>
</tbody></table>
<p>例如，上面源码@Target的定义中有一行<code>@Target(ElementType.ANNOTATION_TYPE)</code>，意思是指当前注解的元素类型是注解类型。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">public enum ElementType &#123;</span><br><span class="line">    &#x2F;** 表示可以用来修饰类、接口、注解类型或枚举类型Class, interface (including annotation type), or enum declaration *&#x2F;</span><br><span class="line">    TYPE,</span><br><span class="line">    &#x2F;** 可以用来修饰属性（包括枚举常量）Field declaration (includes enum constants) *&#x2F;</span><br><span class="line">    FIELD,</span><br><span class="line">    &#x2F;** 可以用来修饰方法Method declaration *&#x2F;</span><br><span class="line">    METHOD,</span><br><span class="line">    &#x2F;** 可以用来修饰参数 Formal parameter declaration *&#x2F;</span><br><span class="line">    PARAMETER,</span><br><span class="line">    &#x2F;** 可以用来修饰构造器 Constructor declaration *&#x2F;</span><br><span class="line">    CONSTRUCTOR,</span><br><span class="line">    &#x2F;** 可用来修饰局部变量Local variable declaration *&#x2F;</span><br><span class="line">    LOCAL_VARIABLE,</span><br><span class="line">    &#x2F;** 可以用来修饰注解类型Annotation type declaration *&#x2F;</span><br><span class="line">    ANNOTATION_TYPE,</span><br><span class="line">    &#x2F;** 可以用来修饰包Package declaration *&#x2F;</span><br><span class="line">    PACKAGE,</span><br><span class="line">    &#x2F;**</span><br><span class="line">     * 标注在类型参数上Type parameter declaration</span><br><span class="line">     *</span><br><span class="line">     * @since 1.8</span><br><span class="line">     *&#x2F;</span><br><span class="line">    TYPE_PARAMETER,</span><br><span class="line">    &#x2F;**</span><br><span class="line">     * 用于标注任意类型(不包括class)Use of a type</span><br><span class="line">     *</span><br><span class="line">     * @since 1.8</span><br><span class="line">     *&#x2F;</span><br><span class="line">    TYPE_USE</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="Retention："><a href="#Retention：" class="headerlink" title="@Retention："></a>@Retention：</h3><p><strong>定义了<code>Annotation</code>的生命周期</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">@Documented</span><br><span class="line">@Retention(RetentionPolicy.RUNTIME)</span><br><span class="line">@Target(ElementType.ANNOTATION_TYPE)</span><br><span class="line">public @interface Retention &#123;</span><br><span class="line">    RetentionPolicy value();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li><p>仅编译期：<code>RetentionPolicy.SOURCE</code>；</p>
</li>
<li><p>仅class文件：<code>RetentionPolicy.CLASS</code>；</p>
</li>
<li><p>运行期：<code>RetentionPolicy.RUNTIME</code>。注解信息将在运行期(JVM)也保留，因此可以通过反射机制读取注解的信息（源码、class文件和执行的时候都有注解的信息）</p>
<p><strong>如果<code>@Retention</code>不存在，则该<code>Annotation</code>默认为<code>CLASS</code>。因为通常我们自定义的<code>Annotation</code>都是<code>RUNTIME</code>，所以，务必要加上<code>@Retention(RetentionPolicy.RUNTIME)</code>这个元注解：</strong></p>
</li>
</ul>
<h3 id="Documented："><a href="#Documented：" class="headerlink" title="@Documented："></a>@Documented：</h3><p><strong>用来描述注解是否被抽取到api文档中。在生成javadoc文档的时候将该Annotation也写入到文档中。</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">@Documented</span><br><span class="line">@Retention(RetentionPolicy.RUNTIME)</span><br><span class="line">@Target(ElementType.ANNOTATION_TYPE)</span><br><span class="line">public @interface Documented &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>@Documented：表示拥有该注解的元素可通过javadoc此类的工具进行文档化。该类型应用于注解那些影响客户使用带注释(comment)的元素声明的类型。如果类型声明是用Documented来注解的，这种类型的注解被作为被标注的程序成员的公共API。</p>
<p>例如，上面源码@Retention的定义中有一行<code>@Documented</code>，意思是指当前注解的元素会被javadoc工具进行文档化，那么在查看Java API文档时可查看当该注解元素。</p>
<h3 id="Inherited："><a href="#Inherited：" class="headerlink" title="@Inherited："></a>@Inherited：</h3><p><strong>如果一个使用了<code>@Inherited</code>修饰的<code>annotation</code>类型被用于一个class，则这个<code>annotation</code>将被用于该class的子类。并且仅针对<code>class</code>的继承，对<code>interface</code>的继承无效：</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">@Documented</span><br><span class="line">@Retention(RetentionPolicy.RUNTIME)</span><br><span class="line">@Target(ElementType.ANNOTATION_TYPE)</span><br><span class="line">public @interface Inherited &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>@Inherited：表示该注解类型被自动继承，如果用户在当前类中查询这个元注解类型并且当前类的声明中不包含这个元注解类型，那么也将自动查询当前类的父类是否存在Inherited元注解，这个动作将被重复执行知道这个标注类型被找到，或者是查询到顶层的父类。</p>
<h3 id="Repeatable："><a href="#Repeatable：" class="headerlink" title="@Repeatable："></a>@Repeatable：</h3><p>它表示在同一个位置重复相同的注解。在没有该注解前，一般是无法在同一个类型上使用相同的注解的。</p>
<h2 id="三、常见注解"><a href="#三、常见注解" class="headerlink" title="三、常见注解"></a>三、常见注解</h2><ul>
<li><p>@Override：用于标记该方法是复写的父类中的某个方法。属于标记注解，不需要设置属性值；只能添加在方法的前面。</p>
</li>
<li><p>@Deprecated：说明被修饰内容已被“废弃”，不再建议用户使用。</p>
</li>
<li><p>@SuppressWarnings：忽略警告。</p>
</li>
<li><p>@TargetApi：版本注解。</p>
</li>
<li><p>@SuppressLint：避免在lint检查时报错</p>
</li>
<li><p><strong>Nullable</strong>：用于标记方法参数或者返回值可以为空；</p>
</li>
<li><p><strong>@NonNull:</strong>用于标记方法参数或者返回值不能为空，如果为空编译器会报警告；</p>
</li>
<li><p>@IdRes：Android中一系列<strong>资源类型注解</strong>。</p>
</li>
<li><p>使用整型常量代替枚举类型</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">public class IceCreamFlavourManager &#123;</span><br><span class="line">    private int flavour;</span><br><span class="line"></span><br><span class="line">    public static final int VANILLA &#x3D; 0;</span><br><span class="line">    public static final int CHOCOLATE &#x3D; 1;</span><br><span class="line">    public static final int STRAWBERRY &#x3D; 2;</span><br><span class="line"></span><br><span class="line">    @IntDef(&#123;VANILLA, CHOCOLATE, STRAWBERRY&#125;)</span><br><span class="line">    public @interface Flavour &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Flavour</span><br><span class="line">    public int getFlavour() &#123;</span><br><span class="line">        return flavour;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void setFlavour(@Flavour int flavour) &#123;</span><br><span class="line">        this.flavour &#x3D; flavour;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>@UiThread :等线程注解</p>
</li>
<li><p>@Size、@IntRange、@FloatRange等值约束注解。</p>
</li>
<li><p>权限注解</p>
</li>
<li><p>@CheckResult：<strong>返回值注解</strong>。</p>
</li>
</ul>
<h2 id="四、自定义注解"><a href="#四、自定义注解" class="headerlink" title="四、自定义注解"></a>四、自定义注解</h2><h3 id="注解定义"><a href="#注解定义" class="headerlink" title="注解定义"></a>注解定义</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">public @interface 注解名 &#123;定义体&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">@Documented</span><br><span class="line">@Target(&#123;ElementType.FIELD, ElementType.PARAMETER&#125;)</span><br><span class="line">@Retention(RetentionPolicy.RUNTIME)</span><br><span class="line">public @interface Test &#123;</span><br><span class="line">	String value() default &quot;&quot;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="使用注解"><a href="#使用注解" class="headerlink" title="使用注解"></a>使用注解</h3><h4 id="编译时期使用注解"><a href="#编译时期使用注解" class="headerlink" title="编译时期使用注解"></a>编译时期使用注解</h4><p>编译时注解指的是@Retention的值为CLASS的注解。对于这类注解的解析，我们只需做好以下两件事儿：</p>
<ul>
<li>自定义一个派生自 AbstractProcessor的“注解处理类”；</li>
<li>重写process 函数。</li>
</ul>
<p>实际上，javac中包含的注解处理器在编译时会自动查找所有继承自 AbstractProcessor 的类，然后调用它们的 process 方法。因此我们只要做好上面两件事，编译器就会主动去解析我们的编译时注解。现在，我们把上面定义的TestAnnotation的Retention改为CLASS，我们就可以按照以下代码来解析它：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">@SupportedAnnotationTypes(&quot;com.zhyen.com.TestAnnotation&quot;)</span><br><span class="line">public class TestAnnotationClass extends AbstractProcessor &#123;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public boolean process(Set&lt;? extends TypeElement&gt; annotations, RoundEnvironment roundEnv) &#123;</span><br><span class="line">        HashMap&lt;String, String&gt; map &#x3D; new HashMap&lt;&gt;();</span><br><span class="line">        for (TypeElement element : annotations) &#123;</span><br><span class="line">            for (Element e : roundEnv.getElementsAnnotatedWith(element)) &#123;</span><br><span class="line">                TestAnnotation annotation&#x3D;e.getAnnotation(TestAnnotation.class);</span><br><span class="line">                map.put(e.getEnclosingElement().toString(),annotation.value());</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        return false;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>SupportedAnnotationTypes注解指出了MyProcessor向要解析的注解的完整名字（全限定名称）。process+函数的annotations参数表示待处理的注解集，通过env我们可以得到被特定注解所修饰的程序元素。process函数的返回值表示annotations中的注解是否被这个Processor接受。&amp;oq=%40SupportedAnnotationTypes注解指出了MyProcessor向要解析的注解的完整名字（全限定名称）。process+函数的annotations参数表示待处理的注解集，通过env我们可以得到被特定注解所修饰的程序元素。process函数的返回值表示annotations中的注解是否被这个Processor接受</p>
<h4 id="运行时期使用直接"><a href="#运行时期使用直接" class="headerlink" title="运行时期使用直接"></a>运行时期使用直接</h4><p>Class 类中提供了以下一些方法用于反射注解：</p>
<ul>
<li><p>getAnnotation：返回指定的注解</p>
</li>
<li><p>isAnnotationPresent：判定当前元素是否被指定注解修饰</p>
</li>
<li><p>getAnnotations：返回所有的注解</p>
</li>
<li><p>getDeclaredAnnotation：返回本元素的指定注解</p>
</li>
<li><p>getDeclaredAnnotations：返回本元素的所有注解，不包含父类继承而来的</p>
</li>
</ul>
<p><strong>方法、字段中相关反射注解的方法基本是类似的</strong></p>
<h2 id="五、小案例一个"><a href="#五、小案例一个" class="headerlink" title="五、小案例一个"></a>五、小案例一个</h2><p>注解类：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">@Documented</span><br><span class="line">@Target(&#123;ElementType.METHOD, ElementType.FIELD&#125;)</span><br><span class="line">@Retention(RetentionPolicy.RUNTIME)</span><br><span class="line">public @interface TestAnnotation &#123;</span><br><span class="line">    String value() default &quot;null&quot;;</span><br><span class="line"></span><br><span class="line">    public String name() default &quot; &quot;;</span><br><span class="line"></span><br><span class="line">    int index() default 1;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>使用类：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">public class TestAnnotationClass &#123;</span><br><span class="line"></span><br><span class="line">    @TestAnnotation(value &#x3D; &quot;汪汪汪&quot;, name &#x3D; &quot;dog&quot;, index &#x3D; 100)</span><br><span class="line">    public String dog;</span><br><span class="line">    @TestAnnotation(value &#x3D; &quot;喵喵喵&quot;, name &#x3D; &quot;cat&quot;, index &#x3D; 200)</span><br><span class="line">    public String cat;</span><br><span class="line"></span><br><span class="line">    @TestAnnotation(value &#x3D; &quot;爱爆炸&quot;, index &#x3D; 10, name &#x3D; &quot;三星&quot;)</span><br><span class="line">    public void phone() &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @TestAnnotation(value &#x3D; &quot;细&quot;, index &#x3D;20, name &#x3D; &quot;ARM&quot;)</span><br><span class="line">    public void CPU() &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>获取注解:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">Class&lt;TestAnnotationClass&gt; clazz &#x3D; TestAnnotationClass.class;</span><br><span class="line">        Field[] fields &#x3D; clazz.getFields();</span><br><span class="line">        for (Field field : fields) &#123;</span><br><span class="line">            TestAnnotation annotation &#x3D; field.getAnnotation(TestAnnotation.class);</span><br><span class="line">            String name &#x3D; annotation.name();</span><br><span class="line">            int index &#x3D; annotation.index();</span><br><span class="line">            String value &#x3D; annotation.value();</span><br><span class="line">            Log.d(TAG, &quot;name &#x3D; &quot; + name + &quot; ,index &#x3D; &quot; + index + &quot;, value &#x3D; &quot; + value);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        TestAnnotation annotation &#x3D; method.getAnnotation(TestAnnotation.class);</span><br><span class="line">            String name &#x3D; annotation.name();</span><br><span class="line">            int index &#x3D; annotation.index();</span><br><span class="line">            String value &#x3D; annotation.value();</span><br><span class="line">            Log.d(TAG, &quot;name &#x3D; &quot; + name + &quot; ,index &#x3D; &quot; + index + &quot;, value &#x3D; &quot; + value);</span><br></pre></td></tr></table></figure>

<p>结果:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">name &#x3D; cat ,index &#x3D; 200, value &#x3D; 喵喵喵</span><br><span class="line">name &#x3D; dog ,index &#x3D; 100, value &#x3D; 汪汪汪</span><br><span class="line">方法名: CPU </span><br><span class="line">name &#x3D; ARM ,index &#x3D; 20, value &#x3D; 细</span><br><span class="line">equals</span><br><span class="line">方法名: getClass</span><br><span class="line">方法名: hashCode</span><br><span class="line">方法名: notify</span><br><span class="line">方法名: phone</span><br><span class="line">name &#x3D; 三星 ,index &#x3D; 10, value &#x3D; 爱爆炸</span><br><span class="line">...</span><br></pre></td></tr></table></figure>


          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/06/06/Android/%E5%BC%80%E5%8F%91/%E5%8A%A8%E7%94%BB/Android%E5%8A%A8%E7%94%BB%E6%8F%92%E5%80%BC%E5%99%A8/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="冯星">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="冯星的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/06/06/Android/%E5%BC%80%E5%8F%91/%E5%8A%A8%E7%94%BB/Android%E5%8A%A8%E7%94%BB%E6%8F%92%E5%80%BC%E5%99%A8/" itemprop="url">Android动画插值器</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-06-06T10:24:12+08:00">
                2020-06-06
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Android/" itemprop="url" rel="index">
                    <span itemprop="name">Android</span>
                  </a>
                </span>

                
                
                  , 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Android/%E5%BC%80%E5%8F%91/" itemprop="url" rel="index">
                    <span itemprop="name">开发</span>
                  </a>
                </span>

                
                
                  , 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Android/%E5%BC%80%E5%8F%91/%E5%8A%A8%E7%94%BB/" itemprop="url" rel="index">
                    <span itemprop="name">动画</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2020/06/06/Android/%E5%BC%80%E5%8F%91/%E5%8A%A8%E7%94%BB/Android%E5%8A%A8%E7%94%BB%E6%8F%92%E5%80%BC%E5%99%A8/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count valine-comment-count" data-xid="/2020/06/06/Android/%E5%BC%80%E5%8F%91/%E5%8A%A8%E7%94%BB/Android%E5%8A%A8%E7%94%BB%E6%8F%92%E5%80%BC%E5%99%A8/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>关于动画有两个非常重要的类，那就是插值器(Interpolators)与 估值器（Evaluators），下面将详细讲解。</p>
<h2 id="一、-差值器概述"><a href="#一、-差值器概述" class="headerlink" title="一、 差值器概述"></a>一、 差值器概述</h2><p>先来看看不同差值器对动画的效果影响。</p>
<h4 id="1-1-线性插值的动画"><a href="#1-1-线性插值的动画" class="headerlink" title="1.1 线性插值的动画"></a>1.1 线性插值的动画</h4><p>图1是在屏幕上进行水平位移的动画，总时间是40ms，移动总距离为40pixels(像素)，每10ms刷新一帧，同时移动10pixels。在第40ms动画结束，停止在水平位置40pixels的位置。整个动画过程采用的是线程插值器（ linear interpolation），意味着以匀速移动。</p>
<p><img src="http://gityuan.com/images/animator/1.png" alt="linear animation"></p>
<h4 id="1-2-非线性插值的动画"><a href="#1-2-非线性插值的动画" class="headerlink" title="1.2 非线性插值的动画"></a>1.2 非线性插值的动画</h4><p>当然，也可以指定差值器是非线性的，图2采用的是先加速，再减速的差值器。同样是在40ms内移动40pixels。在开始的时候，动画一直加速到一半的距离（20pixels）,然后在减速剩下的一半距离直到动画结束。从图2可以看出，动画的两头的位移量低于中间部门的位移量。</p>
<p><img src="http://gityuan.com/images/animator/2.png" alt="non-linear animation"></p>
<h2 id="二、-插值器"><a href="#二、-插值器" class="headerlink" title="二、 插值器"></a>二、 插值器</h2><p>时间插值器，定义了一个时间的函数：y = f(t),其中t=<code>elapsed time</code> / <code>duration</code>.</p>
<p>每个插值器的源码流程都相同，下面以AccelerateInterpolator为例，说明插值器的内部原理：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F;系统自带的所有插值器都继承了BaseInterpolator</span><br><span class="line">public class AccelerateInterpolator extends BaseInterpolator implements NativeInterpolatorFactory &#123;</span><br><span class="line">    private final float mFactor;</span><br><span class="line">    private final double mDoubleFactor;</span><br><span class="line"></span><br><span class="line">    &#x2F;&#x2F;无参数的构造方法, factor默认为1</span><br><span class="line">    public AccelerateInterpolator() &#123;</span><br><span class="line">        mFactor &#x3D; 1.0f;</span><br><span class="line">        mDoubleFactor &#x3D; 2.0;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    &#x2F;&#x2F;有参数的构造方法</span><br><span class="line">    public AccelerateInterpolator(float factor) &#123;</span><br><span class="line">        mFactor &#x3D; factor;</span><br><span class="line">        mDoubleFactor &#x3D; 2 * mFactor;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">     &#x2F;&#x2F;构造方法，通过资源文件获取参数</span><br><span class="line">    public AccelerateInterpolator(Context context, AttributeSet attrs) &#123;</span><br><span class="line">        this(context.getResources(), context.getTheme(), attrs);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    &#x2F;** @hide 隐藏方法，真正用来解析资源文件的方法*&#x2F;</span><br><span class="line">    public AccelerateInterpolator(Resources res, Theme theme, AttributeSet attrs) &#123;</span><br><span class="line">        TypedArray a;</span><br><span class="line">        if (theme !&#x3D; null) &#123;</span><br><span class="line">            a &#x3D; theme.obtainStyledAttributes(attrs, R.styleable.AccelerateInterpolator, 0, 0);</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            a &#x3D; res.obtainAttributes(attrs, R.styleable.AccelerateInterpolator);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        &#x2F;&#x2F;资源文件未定义factor时，默认为1.0f</span><br><span class="line">        mFactor &#x3D; a.getFloat(R.styleable.AccelerateInterpolator_factor, 1.0f);</span><br><span class="line">        mDoubleFactor &#x3D; 2 * mFactor;</span><br><span class="line">        setChangingConfiguration(a.getChangingConfigurations());</span><br><span class="line">        &#x2F;&#x2F; 回收TypedArray，释放相应的内存资源</span><br><span class="line">        a.recycle();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    &#x2F;&#x2F;插值计算的核心方法，定义了插值的映射关系</span><br><span class="line">    public float getInterpolation(float input) &#123;</span><br><span class="line">        if (mFactor &#x3D;&#x3D; 1.0f) &#123;</span><br><span class="line">            return input * input;</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            return (float)Math.pow(input, mDoubleFactor);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    &#x2F;** @hide *&#x2F;</span><br><span class="line">    @Override</span><br><span class="line">    public long createNativeInterpolator() &#123;</span><br><span class="line">        return NativeInterpolatorFactoryHelper.createAccelerateInterpolator(mFactor);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>其中 <code>BaseInterpolaor</code>实现了<code>Interpolator</code>接口，而<code>Interpolator</code>接口并没有定义任何方法和属性，只是单纯地继承了<code>TimeInterpolator</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">abstract public class BaseInterpolator implements Interpolator &#123;</span><br><span class="line">    private int mChangingConfiguration;</span><br><span class="line">    &#x2F;** * @hide *&#x2F;</span><br><span class="line">    public int getChangingConfiguration() &#123;</span><br><span class="line">        return mChangingConfiguration;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    &#x2F;** * @hide *&#x2F;</span><br><span class="line">    void setChangingConfiguration(int changingConfiguration) &#123;</span><br><span class="line">        mChangingConfiguration &#x3D; changingConfiguration;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>TimeInterpolator</code>接口自定义了一个方法<code>getInterpolation</code>,这就是所有插值器最为核心的方法。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">public interface TimeInterpolator &#123;</span><br><span class="line"></span><br><span class="line">    &#x2F;* * @param input 代表动画的已执行的时间，∈[0,1] * @return 插值转换后的值 *&#x2F;</span><br><span class="line">    float getInterpolation(float input);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>通过分析每一个插值器的插值方法的源码，下面总结了所有插值器的插值函数：</p>
<h4 id="2-1-Linear"><a href="#2-1-Linear" class="headerlink" title="2.1 Linear"></a>2.1 Linear</h4><ul>
<li>资源ID: @android:anim/linear_interpolator</li>
<li>构造方法：<ul>
<li><code>public LinearInterpolator()</code>; //没有任何可调参数</li>
</ul>
</li>
<li>插值函数：<ul>
<li>公式：<code>y=t</code></li>
</ul>
</li>
<li>插值曲线：<img src="http://gityuan.com/images/interpolator/1.png" alt="Linear Interpolator"></li>
</ul>
<h4 id="2-2-Accelerate"><a href="#2-2-Accelerate" class="headerlink" title="2.2 Accelerate"></a>2.2 Accelerate</h4><ul>
<li>资源ID: @android:anim/accelerate_interpolator</li>
<li>构造方法：<ul>
<li><code>public AccelerateInterpolator()</code>；//默认factor=1</li>
<li><code>public AccelerateInterpolator(float factor)</code>；</li>
<li><code>public AccelerateInterpolator(Context context, AttributeSet attrs)</code>; //通过资源文件获取factor值，默认为1。</li>
</ul>
</li>
<li>插值函数：factor为加速因子，记为f, 默认值为1<ul>
<li>公式：<code>y=t^(2f)</code></li>
<li>缺省：<code>y=t^2</code></li>
</ul>
</li>
<li>插值曲线：<img src="http://gityuan.com/images/interpolator/2.png" alt="Accelerate Interpolator"></li>
</ul>
<h4 id="2-3-Decelerate"><a href="#2-3-Decelerate" class="headerlink" title="2.3 Decelerate"></a>2.3 Decelerate</h4><ul>
<li>资源ID: @android:anim/decelerate_interpolator</li>
<li>构造方法：<ul>
<li><code>public AccelerateInterpolator()</code>；//默认factor=1</li>
<li><code>public AccelerateInterpolator(float factor)</code>；</li>
<li><code>public AccelerateInterpolator(Context context, AttributeSet attrs)</code>; //通过资源文件获取factor值，默认为1。</li>
</ul>
</li>
<li>插值函数：factor为减速因子，记为f, 默认值为1<ul>
<li>公式：<code>y= 1-(1-t）^(2f)</code>,</li>
<li>缺省：<code>y= 2t-t^2</code></li>
</ul>
</li>
<li>插值曲线：<img src="http://gityuan.com/images/interpolator/3.png" alt="Decelerate Interpolator"></li>
</ul>
<h4 id="2-4-AccelerateDecelerate"><a href="#2-4-AccelerateDecelerate" class="headerlink" title="2.4 AccelerateDecelerate"></a>2.4 AccelerateDecelerate</h4><ul>
<li>资源ID: @android:anim/accelerate_decelerate_interpolator</li>
<li>构造方法：<ul>
<li><code>public AccelerateDecelerateInterpolator()</code>； //没有任何可调参数 资源文件获取factor值。</li>
</ul>
</li>
<li>插值函数：<ul>
<li>公式：<code>y = 0.5cos((t+1)π)+0.5</code></li>
</ul>
</li>
<li>插值曲线：<img src="http://gityuan.com/images/interpolator/4.png" alt="AccelerateDecelerate Interpolator"></li>
</ul>
<h4 id="2-5-Anticipate"><a href="#2-5-Anticipate" class="headerlink" title="2.5 Anticipate"></a>2.5 Anticipate</h4><ul>
<li>资源ID: @android:anim/anticipate_interpolator</li>
<li>构造方法：<ul>
<li><code>public AnticipateInterpolator()</code>；//默认tension=2</li>
<li><code>public AnticipateInterpolator(float tension)</code>；</li>
<li><code>public AnticipateInterpolator(Context context, AttributeSet attrs)</code>; //通过资源文件获取tension值。</li>
</ul>
</li>
<li>插值函数：tension`为张力因子，记为s, 默认值为2<ul>
<li>公式：<code>y = t*t*((s+1)t-s)</code>,</li>
<li>缺省：<code>y = t*t*(3t-2)</code></li>
</ul>
</li>
<li>插值曲线：<img src="http://gityuan.com/images/interpolator/5.png" alt="Anticipate Interpolator"></li>
</ul>
<h4 id="2-6-Overshoot"><a href="#2-6-Overshoot" class="headerlink" title="2.6 Overshoot"></a>2.6 Overshoot</h4><ul>
<li>资源ID: @android:anim/overshoot_interpolator</li>
<li>构造方法：<ul>
<li><code>public OvershootInterpolator()</code>；//默认tension=2</li>
<li><code>public OvershootInterpolator(float tension)</code>；</li>
<li><code>public OvershootInterpolator(Context context, AttributeSet attrs)</code>; //通过资源文件获取tension值。</li>
</ul>
</li>
<li>插值函数：tension`为张力因子，记为s, 默认值为2<ul>
<li>公式：<code>y = (t-1)(t-1)((s+1)(t-1)+s) + 1</code>,</li>
<li>缺省：<code>y = (t-1)(t-1)(3t-1) + 1</code></li>
</ul>
</li>
<li>插值曲线：<img src="http://gityuan.com/images/interpolator/6.png" alt=" Overshoot Interpolator"></li>
</ul>
<h4 id="2-7-AnticipateOvershoot"><a href="#2-7-AnticipateOvershoot" class="headerlink" title="2.7 AnticipateOvershoot"></a>2.7 AnticipateOvershoot</h4><ul>
<li>资源ID: @android:anim/anticipate_overshoot_interpolator</li>
<li>构造方法：<ul>
<li><code>public AnticipateOvershootInterpolator()</code>；//默认tension=3</li>
<li><code>public AnticipateOvershootInterpolator(float tension)</code>； //tension = 1.5*tension</li>
<li><code>public AnticipateOvershootInterpolator(float tension, float extraTension)</code>; //tension = tension * extraTension</li>
<li><code>public AnticipateOvershootInterpolator(Context context, AttributeSet attrs)</code>; //通过资源文件获取tension值。</li>
</ul>
</li>
<li>插值函数：tension`为张力因子，记为s<ul>
<li>公式：<ul>
<li><code>y = 2t*t*(2t*s+2t-s), 当t &lt; 0.5时</code>,</li>
<li><code>y = 2(t-1)(t-1)(2(s+1)(t-1)+s) + 1 , 当t &gt;= 0.5时</code>,</li>
</ul>
</li>
<li>缺省：<ul>
<li><code>y = 2t*t*(8t-3), 当t &lt; 0.5时</code>,</li>
<li><code>y = 2(t-1)(t-1)(8t-5) + 1 , 当t &gt;= 0.5时</code>,</li>
</ul>
</li>
</ul>
</li>
<li>插值曲线：<img src="http://gityuan.com/images/interpolator/7.png" alt=" AnticipateOvershoot Interpolator"></li>
</ul>
<h4 id="2-8-Bounce"><a href="#2-8-Bounce" class="headerlink" title="2.8 Bounce"></a>2.8 Bounce</h4><ul>
<li>资源ID: @android:anim/bounce_interpolator</li>
<li>构造方法：<ul>
<li><code>public BounceInterpolator()</code>；//没有任何可调参数</li>
</ul>
</li>
<li>插值函数：<ul>
<li>公式：<ul>
<li>y = 8*(1.1226t)^2 ，当 t &lt; 0.3535</li>
<li>y = 8*(1.1226t - 0.54719)^2 + 0.7 ，当 t &lt; 0.7408</li>
<li>y = 8*(1.1226t - 0.8526)^2 + 0.9 ，当 t &lt; 0.9644</li>
<li>y = 8*(1.1226t - 1.0435)^2 + 0.95 ，当 t &lt;= 1.0</li>
</ul>
</li>
</ul>
</li>
<li>插值曲线：<img src="http://gityuan.com/images/interpolator/8.png" alt="Bounce Interpolator"></li>
</ul>
<h4 id="2-9-Cycle"><a href="#2-9-Cycle" class="headerlink" title="2.9 Cycle"></a>2.9 Cycle</h4><ul>
<li>资源ID: @android:anim/cycle_interpolator</li>
<li>构造方法：<ul>
<li><code>public CycleInterpolator(float cycles)</code>；</li>
<li><code>public CycleInterpolator(Context context, AttributeSet attrs)</code>; //通过资源文件获取cycles值，默认为1。</li>
</ul>
</li>
<li>插值函数：cycles`为循环次数，记为c<ul>
<li>公式：<code>y = sin（2*c*t*π）</code>,</li>
<li>缺省：<code>y = sin（2*t*π）</code></li>
</ul>
</li>
<li>插值曲线：<img src="http://gityuan.com/images/interpolator/9.png" alt=" Cycle Interpolator"></li>
</ul>
<hr>
<h2 id="三、-估值器"><a href="#三、-估值器" class="headerlink" title="三、 估值器"></a>三、 估值器</h2><p>估值器，用于计算属性动画的给定属性的取值，与属性的起始值，结束值，<code>fraction</code>三个值相关。</p>
<p>每个估值器的源码流程都相似，所有的估值器都实现了TypeEvaluator接口，接口采用泛型，可自定义各种类型的估值器，只需实现如下接口即可：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">public interface TypeEvaluator&lt;T&gt; &#123;</span><br><span class="line">    &#x2F;* * * @param fraction 插值器计算转换后的值 * @param startValue 属性起始值 * @param endValue 属性结束值 * @return 转换后的值 *&#x2F;</span><br><span class="line">    public T evaluate(float fraction, T startValue, T endValue);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="3-1-IntEvaluator"><a href="#3-1-IntEvaluator" class="headerlink" title="3.1 IntEvaluator"></a>3.1 IntEvaluator</h4><p>用于评估Integer型的属性值，起始值与结束值，以及evaluate返回值都是Integer类型。评估的返回值与fraction成一次函数，即线性关系。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">public class IntEvaluator implements TypeEvaluator&lt;Integer&gt; &#123;</span><br><span class="line"></span><br><span class="line">    &#x2F;** * 函数关系：result &#x3D; x0 + t * (x1 - x0) * * @param fraction * @param startValue 属性起始值，Integer类型 * @param endValue 属性结束值，Integer类型 * @return 与fraction成线性关系。 *&#x2F;</span><br><span class="line">    public Integer evaluate(float fraction, Integer startValue, Integer endValue) &#123;</span><br><span class="line">        int startInt &#x3D; startValue;</span><br><span class="line">        return (int)(startInt + fraction * (endValue - startInt));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="3-2-FloatEvaluator"><a href="#3-2-FloatEvaluator" class="headerlink" title="3.2 FloatEvaluator"></a>3.2 FloatEvaluator</h4><p>用于评估Float型的属性值，起始值与结束值，以及evaluate返回值都是Float类型，同样也是线程关系。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">public class FloatEvaluator implements TypeEvaluator&lt;Number&gt; &#123;</span><br><span class="line"></span><br><span class="line">    &#x2F;** * @param fraction * @param startValue 属性起始值，float类型 * @param endValue 属性结束值，float类型 * @return 与fraction成线性关系。 *&#x2F;</span><br><span class="line">    public Float evaluate(float fraction, Number startValue, Number endValue) &#123;</span><br><span class="line">    float startFloat &#x3D; startValue.floatValue();</span><br><span class="line">    return startFloat + fraction * (endValue.floatValue() - startFloat);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="3-3-ArgbEvaluator"><a href="#3-3-ArgbEvaluator" class="headerlink" title="3.3 ArgbEvaluator"></a>3.3 ArgbEvaluator</h4><p>用于评估颜色的属性值，采用16进制。将ARGB四个量，同步进行动画渐变，同样也是采用线性的。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">public class ArgbEvaluator implements TypeEvaluator &#123;</span><br><span class="line">    private static final ArgbEvaluator sInstance &#x3D; new ArgbEvaluator();</span><br><span class="line"></span><br><span class="line">   &#x2F;* * @hide * 貌似采用单例的方式，可该方法确实@hide隐藏方法，同时并没有将构造方法定义为private。 * 意味着单例对于上层开发者来说是不可见的，这样单例就没有起效果，google难道只是为了framework * 的单例使用，很诡异的设计。 *&#x2F;</span><br><span class="line">    public static ArgbEvaluator getInstance() &#123;</span><br><span class="line">        return sInstance;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public Object evaluate(float fraction, Object startValue, Object endValue) &#123;</span><br><span class="line">        int startInt &#x3D; (Integer) startValue;</span><br><span class="line">        int startA &#x3D; (startInt &gt;&gt; 24) &amp; 0xff;</span><br><span class="line">        int startR &#x3D; (startInt &gt;&gt; 16) &amp; 0xff;</span><br><span class="line">        int startG &#x3D; (startInt &gt;&gt; 8) &amp; 0xff;</span><br><span class="line">        int startB &#x3D; startInt &amp; 0xff;</span><br><span class="line"></span><br><span class="line">        int endInt &#x3D; (Integer) endValue;</span><br><span class="line">        int endA &#x3D; (endInt &gt;&gt; 24) &amp; 0xff;</span><br><span class="line">        int endR &#x3D; (endInt &gt;&gt; 16) &amp; 0xff;</span><br><span class="line">        int endG &#x3D; (endInt &gt;&gt; 8) &amp; 0xff;</span><br><span class="line">        int endB &#x3D; endInt &amp; 0xff;</span><br><span class="line"></span><br><span class="line">        return (int)((startA + (int)(fraction * (endA - startA))) &lt;&lt; 24) |</span><br><span class="line">                (int)((startR + (int)(fraction * (endR - startR))) &lt;&lt; 16) |</span><br><span class="line">                (int)((startG + (int)(fraction * (endG - startG))) &lt;&lt; 8) |</span><br><span class="line">                (int)((startB + (int)(fraction * (endB - startB))));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="四、小结"><a href="#四、小结" class="headerlink" title="四、小结"></a>四、小结</h2><p>本文主要分两部分，插值器与估值器。通过源码方式概括性分析插值器的代码实现方式；再从数学角度，逐一进行剖析系统自带的9种插值器的插值函数以及其插值曲线。对于3种Evaluators，通过分析源码，其方式较为简单，需要注意的一点是evaluate中的fraction是插值器转换后的值，而不是<code>elapsed time</code>。</p>
<hr>
<p><strong>微信公众号</strong> <a href="http://gityuan.com/images/about-me/gityuan_weixin_logo.png" target="_blank" rel="noopener"><strong>Gityuan</strong> </a><strong>| 微博</strong> <a href="http://weibo.com/gityuan" target="_blank" rel="noopener"><strong>weibo.com/gityuan</strong> </a><strong>| 博客</strong> <a href="http://gityuan.com/talk/" target="_blank" rel="noopener"><strong>留言区交流</strong></a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/06/05/Android/%E5%BC%80%E5%8F%91/%E5%8A%A8%E7%94%BB/Android%E4%B8%89%E7%A7%8D%E5%8A%A8%E7%94%BB%E5%AE%9E%E7%8E%B0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="冯星">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="冯星的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/06/05/Android/%E5%BC%80%E5%8F%91/%E5%8A%A8%E7%94%BB/Android%E4%B8%89%E7%A7%8D%E5%8A%A8%E7%94%BB%E5%AE%9E%E7%8E%B0/" itemprop="url">Android三种动画实现</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-06-05T21:45:37+08:00">
                2020-06-05
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Android/" itemprop="url" rel="index">
                    <span itemprop="name">Android</span>
                  </a>
                </span>

                
                
                  , 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Android/%E5%BC%80%E5%8F%91/" itemprop="url" rel="index">
                    <span itemprop="name">开发</span>
                  </a>
                </span>

                
                
                  , 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Android/%E5%BC%80%E5%8F%91/%E5%8A%A8%E7%94%BB/" itemprop="url" rel="index">
                    <span itemprop="name">动画</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2020/06/05/Android/%E5%BC%80%E5%8F%91/%E5%8A%A8%E7%94%BB/Android%E4%B8%89%E7%A7%8D%E5%8A%A8%E7%94%BB%E5%AE%9E%E7%8E%B0/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count valine-comment-count" data-xid="/2020/06/05/Android/%E5%BC%80%E5%8F%91/%E5%8A%A8%E7%94%BB/Android%E4%B8%89%E7%A7%8D%E5%8A%A8%E7%94%BB%E5%AE%9E%E7%8E%B0/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <blockquote>
<p>作为Android开发者，动画是非常重要的知识点，本文主要从入门角度来探索动画。</p>
</blockquote>
<h2 id="一、概述"><a href="#一、概述" class="headerlink" title="一、概述"></a>一、概述</h2><p>Android的动画主要包括三大类：逐帧动画Frame、补间动画Tween、属性动画，其中属性动画功能非常强大，也是最常用的动画方法。 下面先列举一下这3类动画的实例代码，已形成初步印象：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//逐帧动画，需资源文件frame_animation.xml</span></span><br><span class="line">ImageView img = (ImageView)findViewById(R.id.wheel_image);</span><br><span class="line">img.setBackgroundResource(R.drawable.frame_animation);</span><br><span class="line">AnimationDrawable frameAnimation = (AnimationDrawable) img.getBackground();</span><br><span class="line">frameAnimation.start();</span><br><span class="line"></span><br><span class="line"><span class="comment">//补间动画，需资源文件tween_animation.xml</span></span><br><span class="line">ImageView img = (ImageView)findViewById(R.id.wheel_image);</span><br><span class="line">Animation tweenAnimation = AnimationUtils.loadAnimation(<span class="keyword">this</span>, R.anim.tween_animation);</span><br><span class="line">img.startAnimation(tweenAnimation);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 属性动画，不需资源文件</span></span><br><span class="line">ObjectAnimator anim = ObjectAnimator.ofFloat(targetObject, <span class="string">"alpha"</span>, <span class="number">0f</span>, <span class="number">1f</span>);</span><br><span class="line">anim.setDuration(<span class="number">1000</span>);</span><br><span class="line">anim.start();</span><br></pre></td></tr></table></figure>

<p>接下来，再来细说各种动画。</p>
<h2 id="二、逐帧动画Frame"><a href="#二、逐帧动画Frame" class="headerlink" title="二、逐帧动画Frame"></a>二、逐帧动画Frame</h2><p>逐帧动画是最容易理解，最简单的动画。但需要把动画过程的每一帧静态图片都放到资源文件夹<code>res/drawbale</code>下，然后由Android来控制依次显示这些静态图片，利用人眼“视觉暂留”的原理，从而产生“动画”的错觉。实现方式与电影、动漫的原理一样。</p>
<p>每一帧的图片，可以是比如.jpg, .png格式的图片文件，也可以是通过xml定义的图形。下面通过一个实例来讲解逐帧动画的使用。</p>
<h4 id="2-1-动画资源文件"><a href="#2-1-动画资源文件" class="headerlink" title="2.1 动画资源文件"></a>2.1 动画资源文件</h4><p><code>frame_animation.xml</code>放在文件夹<code>res/drawable/</code>下，该逐帧动画包含3张图片wheel0.png, wheel1.png, wheel2.png:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;animation-list android:id&#x3D;&quot;@+id&#x2F;selected&quot; android:oneshot&#x3D;&quot;false&quot;&gt;</span><br><span class="line">   &lt;item android:drawable&#x3D;&quot;@drawable&#x2F;wheel0&quot; android:duration&#x3D;&quot;50&quot; &#x2F;&gt;</span><br><span class="line">   &lt;item android:drawable&#x3D;&quot;@drawable&#x2F;wheel1&quot; android:duration&#x3D;&quot;50&quot; &#x2F;&gt;</span><br><span class="line">   &lt;item android:drawable&#x3D;&quot;@drawable&#x2F;wheel2&quot; android:duration&#x3D;&quot;50&quot; &#x2F;&gt;</span><br><span class="line">&lt;&#x2F;animation-list&gt;</span><br></pre></td></tr></table></figure>

<h4 id="2-2-代码实现"><a href="#2-2-代码实现" class="headerlink" title="2.2 代码实现"></a>2.2 代码实现</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ImageView img &#x3D; (ImageView)findViewById(R.id.wheel_image);</span><br><span class="line">img.setBackgroundResource(R.drawable.frame_animation);</span><br><span class="line">AnimationDrawable frameAnimation &#x3D; (AnimationDrawable) img.getBackground();</span><br><span class="line">frameAnimation.start();</span><br></pre></td></tr></table></figure>

<p><strong>参数说明</strong></p>
<ul>
<li>android:oneshot， 其值为true则动画只播放一遍, false则循环播放;</li>
<li>android:duration，代表该帧时长，单位ms(毫秒)。</li>
</ul>
<h2 id="三、补间动画Tween"><a href="#三、补间动画Tween" class="headerlink" title="三、补间动画Tween"></a>三、补间动画Tween</h2><p>补间动画，只需指定动画开始帧、结束帧，而对于动画中间的过程，都有系统计算来填充的，而无需定义中间的每一帧。 动画变化主要包括4类型：</p>
<ul>
<li>Alpha：透明度动画</li>
<li>Scale：缩放动画</li>
<li>Translate：位移动画</li>
<li>RotateAnaimation：旋转动画</li>
</ul>
<h4 id="3-1-动画资源文件"><a href="#3-1-动画资源文件" class="headerlink" title="3.1 动画资源文件"></a>3.1 动画资源文件</h4><p><code>tween_animation.xml</code>放在文件夹<code>res/anim/</code>下, 该动画同时包括透明度，缩放，位移，旋转4种变化，当然也可以是其中一种，或几种变化的组合。</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=<span class="string">"1.0"</span> encoding=<span class="string">"utf-8"</span>?&gt;</span><br><span class="line">&lt;set xmlns:android=<span class="string">"http://schemas.android.com/apk/res/android"</span></span><br><span class="line">    android:interpolator=<span class="string">"@[package:]anim/interpolator_resource"</span></span><br><span class="line">    android:shareInterpolator=<span class="string">"true"</span>&gt;</span><br><span class="line"></span><br><span class="line">    &lt;alpha</span><br><span class="line">        android:fromAlpha=<span class="string">"0.5"</span></span><br><span class="line">        android:toAlpha=<span class="string">"1.0"</span></span><br><span class="line">        android:duration=<span class="string">"1000"</span> /&gt;</span><br><span class="line"></span><br><span class="line">    &lt;scale</span><br><span class="line">        android:fromXScale=<span class="string">"0.01"</span></span><br><span class="line">        android:toXScale=<span class="string">"1.0"</span></span><br><span class="line">        android:fromYScale=<span class="string">"0.01"</span></span><br><span class="line">        android:toYScale=<span class="string">"1.0"</span></span><br><span class="line">        android:pivotX=<span class="string">"50%"</span></span><br><span class="line">        android:pivotY=<span class="string">"50%"</span></span><br><span class="line">        android:fillAfter=<span class="string">"true"</span> /&gt;</span><br><span class="line"></span><br><span class="line">    &lt;translate</span><br><span class="line">        android:fromXDelta=<span class="string">"0.01"</span></span><br><span class="line">        android:toXDelta=<span class="string">"0.95"</span></span><br><span class="line">        android:fromYDelta=<span class="string">"0.01"</span></span><br><span class="line">        android:toYDelta=<span class="string">"0.95"</span> /&gt;</span><br><span class="line"></span><br><span class="line">    &lt;rotate</span><br><span class="line">        android:fromDegrees=<span class="string">"0.01"</span></span><br><span class="line">        android:toDegrees=<span class="string">"360"</span></span><br><span class="line">        android:pivotX=<span class="string">"50%"</span></span><br><span class="line">        android:pivotY=<span class="string">"50%"</span> /&gt;</span><br><span class="line">&lt;/set&gt;</span><br></pre></td></tr></table></figure>

<h4 id="3-2-代码实现"><a href="#3-2-代码实现" class="headerlink" title="3.2 代码实现"></a>3.2 代码实现</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ImageView img &#x3D; (ImageView)findViewById(R.id.wheel_image);</span><br><span class="line">Animation tweenAnimation &#x3D; AnimationUtils.loadAnimation(this, R.anim.tween_animation);</span><br><span class="line">img.startAnimation(tweenAnimation);</span><br></pre></td></tr></table></figure>

<h4 id="3-3-参数说明"><a href="#3-3-参数说明" class="headerlink" title="3.3 参数说明"></a>3.3 参数说明</h4><ul>
<li>android:interpolator 插值器，指定动画的效果，见<a href="http://gityuan.com/2015/09/05/android-anaimator-3/" target="_blank" rel="noopener"><strong>Android动画插值器</strong></a>；</li>
<li>android:shareInterpolator， true：所有子元素共享同一插值器；false不共享；</li>
<li>android:fillBefore， true：动画执行完成后停留在动画的第一帧；</li>
<li>android:fillAfter ， true：动画执行完成后停留在动画的最后一帧；</li>
<li>android:fillEnabled，true：fillBefore/fillAfter才能生效</li>
<li>android:duration， 动画持续时长，每一个动画都可以单独指定duration，单位ms(毫秒)</li>
<li>alpha，透明度动画，其中0表示完全透明，1表示完全不透明：<ul>
<li>fromAlpha： 起始透明度</li>
<li>toAlpha ： 结束透明度</li>
</ul>
</li>
<li>scale，缩放动画，其中0表示收缩到无，1表示正常无缩放：<ul>
<li>fromXScale： 起始X坐标的缩放比例</li>
<li>toXScale ： 结束X坐标的缩放比例</li>
<li>fromYScale： 起始Y坐标的缩放比例</li>
<li>toYScale ： 结束Y坐标的缩放比例</li>
<li>pivotX ： 轴中点X坐标的位置比例</li>
<li>pivotY ： 轴中点Y坐标的位置比例</li>
</ul>
</li>
<li>translate，位移动画：<ul>
<li>fromXDelta： 起始X方向位置比例</li>
<li>toXDelta ： 结束X方向位置比例</li>
<li>fromYDelta： 起始Y方向位置比例</li>
<li>toYDelta ： 结束Y方向位置比例</li>
</ul>
</li>
<li>rotate， 旋转动画：<ul>
<li>fromDegrees： 起始角度，单位度</li>
<li>toDegrees ： 结束角度，单位度</li>
<li>pivotX ： 旋转中点X坐标的位置比例</li>
<li>pivotY ： 旋转中点Y坐标的位置比例</li>
</ul>
</li>
</ul>
<hr>
<h2 id="四、属性动画"><a href="#四、属性动画" class="headerlink" title="四、属性动画"></a>四、属性动画</h2><p>属性动画，是补间动画的增强版，但更加灵活。可直接修改任何属性，使之形成动画，功能非常强大，也是最常用的动画。 属性动画自定义如下属性：</p>
<ul>
<li>动画时间（Duration）：指定动画总共完成所需要的时间，默认为300ms;</li>
<li>时间插值器（Time interpolation）： 是一个基于当前动画已消耗时间的函数，用来计算属性的值；</li>
<li>重复次数（Repeat count）：指定动画是否重复执行，重复执行的次数，也可以指定动画向反方向地回退操作；</li>
<li>动画集（Animator sets）：将一系列动画放进一个组，可以设置同时执行或者按序执行；</li>
<li>延迟刷新时间（Frame refresh delay）：指定动画刷新的频率，默认为每10ms刷新一帧，但应用程序的帧的刷新频率最终取决于整个系统的忙闲程序与系统的时钟频率。</li>
</ul>
<h3 id="4-1-属性动画类"><a href="#4-1-属性动画类" class="headerlink" title="4.1 属性动画类"></a>4.1 属性动画类</h3><p><img src="http://gityuan.com/images/animator/3.jpg" alt="animations work"></p>
<p>上图描述了属性动画在绘制动画过程的相关类：</p>
<ul>
<li>ValueAnimator：记录动画的运行时间，位移，当前将要绘制的属性</li>
<li>TimeInterpolator：时间插值器，用于根据随着时间的变化来计算当前属性变化的百分比</li>
<li>TypeEvaluator：估值器，用于根据属性改变的百分比来计算改变后的属性值</li>
</ul>
<p>属性动画设置好起始值和结束值，执行总时间等参数。当调用start()动画开始， 在整个动画期间，ValueAnimator计算已绘制的时间比(elapsed fraction)，区间[0,1]，代表动画的完成率。动画运行过程中，通过调用onAnimationUpdate方法来更新画面，getAnimatedValue()获取当前动画的property。</p>
<h4 id="4-1-1-ValueAnimator"><a href="#4-1-1-ValueAnimator" class="headerlink" title="4.1.1 ValueAnimator"></a>4.1.1 ValueAnimator</h4><p>Animator类提供了关于创造动画的一系列基本的结构，是一个抽象类。ValueAnimator是整个属性动画框架的核心类，使用方法如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ValueAnimator valueAnim &#x3D; ValueAnimator.ofFloat(0f, 1f);</span><br><span class="line">valueAnim.setDuration(250);</span><br><span class="line">fadeAnim.start();</span><br></pre></td></tr></table></figure>

<p>再通过动画的<code>AnimatorUpdateListener</code>获取动画每一帧的返回值，如果有需要还可以增加<code>AnimatorListenerAdapter</code>来指定动画开始、结束、取消、重复等事件发生时的处理方法。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">valueAnim.addUpdateListener(new AnimatorUpdateListener() &#123;</span><br><span class="line">    @Override</span><br><span class="line">        public void onAnimationUpdate(ValueAnimator animation) &#123;</span><br><span class="line">        int frameValue &#x3D; (Integer)animation.getAnimatedValue();</span><br><span class="line">        &#x2F;&#x2F;根据frameValue指定相应的透明度，位移，旋转，缩放等相应的动画</span><br><span class="line">        balls.setAlpha(frameValue);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">valueAnim.addListener(new AnimatorListenerAdapter() &#123;</span><br><span class="line">    public void onAnimationEnd(Animator animation) &#123;</span><br><span class="line">        &#x2F;&#x2F;当动画结束时移除相应对象</span><br><span class="line">        balls.remove(((ObjectAnimator)animation).getTarget());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h4 id="4-1-2-ObjectAnimator"><a href="#4-1-2-ObjectAnimator" class="headerlink" title="4.1.2 ObjectAnimator"></a>4.1.2 ObjectAnimator</h4><p>对象动画，继承<code>ValueAnimator</code>, 允许指定<code>target object</code>，并且<code>target object</code>需要有setter方法。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ObjectAnimator anim &#x3D; ObjectAnimator.ofFloat(targetObject, &quot;alpha&quot;, 0f, 1f);</span><br><span class="line">anim.setDuration(1000);</span><br><span class="line">anim.start();</span><br></pre></td></tr></table></figure>

<h4 id="4-1-3-AnimatorSet"><a href="#4-1-3-AnimatorSet" class="headerlink" title="4.1.3 AnimatorSet"></a>4.1.3 AnimatorSet</h4><p>动画的集合，用于组合一系列动画。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">AnimatorSet  animatorSet &#x3D; new AnimatorSet();</span><br><span class="line">animatorSet.play(bounceAnim).before(squashAnim1);</span><br><span class="line">animatorSet.play(squashAnim1).with(squashAnim2);</span><br><span class="line">animatorSet.play(bounceBackAnim).after(stretchAnim2);</span><br><span class="line">animatorSet.start();</span><br></pre></td></tr></table></figure>

<h3 id="4-2-代码实现"><a href="#4-2-代码实现" class="headerlink" title="4.2 代码实现"></a>4.2 代码实现</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; 属性动画，不需资源文件</span><br><span class="line">ObjectAnimator anim &#x3D; ObjectAnimator.ofFloat(targetObject, &quot;alpha&quot;, 0f, 1f);</span><br><span class="line">anim.setDuration(1000);</span><br><span class="line">anim.start();</span><br></pre></td></tr></table></figure>

<h3 id="4-3-插值器（Interpolators）"><a href="#4-3-插值器（Interpolators）" class="headerlink" title="4.3 插值器（Interpolators）"></a>4.3 插值器（Interpolators）</h3><p>时间插值器，定义了一个时间的映射关系，可能为如下的插值器：</p>
<table>
<thead>
<tr>
<th align="left">插值器</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody><tr>
<td align="left">LinearInterpolator</td>
<td align="left">线性插值</td>
</tr>
<tr>
<td align="left">AccelerateInterpolator</td>
<td align="left">加速</td>
</tr>
<tr>
<td align="left">DecelerateInterpolator</td>
<td align="left">减速</td>
</tr>
<tr>
<td align="left">AccelerateDecelerateInterpolator</td>
<td align="left">先加速，后减速</td>
</tr>
<tr>
<td align="left">AnticipateInterpolator</td>
<td align="left">先向后，再向前抛向终点</td>
</tr>
<tr>
<td align="left">OvershootInterpolator</td>
<td align="left">向前抛出终点，再回到终点</td>
</tr>
<tr>
<td align="left">AnticipateOvershootInterpolator</td>
<td align="left">先向后，再向前抛出终点，再回到终点</td>
</tr>
<tr>
<td align="left">BounceInterpolator</td>
<td align="left">结束时反弹</td>
</tr>
<tr>
<td align="left">CycleInterpolator</td>
<td align="left">循环播放</td>
</tr>
<tr>
<td align="left">TimeInterpolator</td>
<td align="left">用于自定义</td>
</tr>
</tbody></table>
<p>所有插值器都实现了TimeInterpolator接口，需要自定义插值器，只需实现如下接口：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">public interface TimeInterpolator &#123;</span><br><span class="line"></span><br><span class="line">    &#x2F;* * @param input 代表动画的已执行的时间，∈[0,1] * @return 插值转换后的值 *&#x2F;</span><br><span class="line">    float getInterpolation(float input);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>想要更加深入地了解插值器，可查看<a href="http://gityuan.com/2015/09/05/android-anaimator-3/" target="_blank" rel="noopener"><strong>Android动画插值器</strong></a>。</p>
<h3 id="4-4-估值器（Evaluators）"><a href="#4-4-估值器（Evaluators）" class="headerlink" title="4.4 估值器（Evaluators）"></a>4.4 估值器（Evaluators）</h3><p>估值器，用于计算属性动画的给定属性的取值。与属性的起始值，结束值，<code>fraction</code>三个值相关。</p>
<table>
<thead>
<tr>
<th align="left">估值器</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody><tr>
<td align="left">IntEvaluator</td>
<td align="left">用于评估int型的属性值</td>
</tr>
<tr>
<td align="left">FloatEvaluator</td>
<td align="left">用于评估float型的属性值</td>
</tr>
<tr>
<td align="left">ArgbEvaluator</td>
<td align="left">用于评估颜色的属性值，采用16进制</td>
</tr>
<tr>
<td align="left">TypeEvaluator</td>
<td align="left">用于自定义估值器的接口</td>
</tr>
</tbody></table>
<p>所有的估值器都实现了TypeEvaluator接口，自定义估值器，只需实现如下接口：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">public interface TypeEvaluator&lt;T&gt; &#123;</span><br><span class="line">    &#x2F;* * * @param fraction 插值器计算转换后的值 * @param startValue 属性起始值 * @param endValue 属性结束值 * @return 转换后的值 *&#x2F;</span><br><span class="line">    public T evaluate(float fraction, T startValue, T endValue);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="五、小结"><a href="#五、小结" class="headerlink" title="五、小结"></a>五、小结</h2><p>相信读者，通过阅读动画入门这两篇文章，对逐帧动画，补间动画，属性动画有了一个大致的概念与理解，能明白动画的基本用法。 相关资料：<a href="http://developer.android.com/intl/zh-cn/guide/topics/graphics/prop-animation.html" target="_blank" rel="noopener">http://developer.android.com/intl/zh-cn/guide/topics/graphics/prop-animation.html</a></p>
<p>如果有兴趣深入了解动画的机制，可查看<a href="http://gityuan.com/2015/09/06/android-anaimator-4/" target="_blank" rel="noopener"><strong>Android动画之原理篇（四）</strong></a>，从源码的视角来进一步阐述动画的原理。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/06/05/Android%E4%BA%8B%E4%BB%B6%E5%88%86%E5%8F%91%E6%9C%BA%E5%88%B6/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="冯星">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="冯星的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/06/05/Android%E4%BA%8B%E4%BB%B6%E5%88%86%E5%8F%91%E6%9C%BA%E5%88%B6/" itemprop="url">Android事件分发机制</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-06-05T18:02:05+08:00">
                2020-06-05
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2020/06/05/Android%E4%BA%8B%E4%BB%B6%E5%88%86%E5%8F%91%E6%9C%BA%E5%88%B6/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count valine-comment-count" data-xid="/2020/06/05/Android%E4%BA%8B%E4%BB%B6%E5%88%86%E5%8F%91%E6%9C%BA%E5%88%B6/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/06/05/Java/%E7%B1%BB%E5%8A%A0%E8%BD%BD%E5%99%A8/Java%E7%B1%BB%E5%8A%A0%E8%BD%BD%E5%99%A8-ClassLoader/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="冯星">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="冯星的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/06/05/Java/%E7%B1%BB%E5%8A%A0%E8%BD%BD%E5%99%A8/Java%E7%B1%BB%E5%8A%A0%E8%BD%BD%E5%99%A8-ClassLoader/" itemprop="url">Java类加载器-ClassLoader</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-06-05T15:16:57+08:00">
                2020-06-05
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Java/" itemprop="url" rel="index">
                    <span itemprop="name">Java</span>
                  </a>
                </span>

                
                
                  , 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Java/%E7%B1%BB%E5%8A%A0%E8%BD%BD%E5%99%A8/" itemprop="url" rel="index">
                    <span itemprop="name">类加载器</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2020/06/05/Java/%E7%B1%BB%E5%8A%A0%E8%BD%BD%E5%99%A8/Java%E7%B1%BB%E5%8A%A0%E8%BD%BD%E5%99%A8-ClassLoader/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count valine-comment-count" data-xid="/2020/06/05/Java/%E7%B1%BB%E5%8A%A0%E8%BD%BD%E5%99%A8/Java%E7%B1%BB%E5%8A%A0%E8%BD%BD%E5%99%A8-ClassLoader/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <blockquote>
<p>本文主要讲述Java ClassLoader的工作原理，为后面将Android App代码热替换或者插件化升级做铺垫</p>
</blockquote>
<h2 id="一、-类加载器"><a href="#一、-类加载器" class="headerlink" title="一、 类加载器"></a>一、 类加载器</h2><p>ClassLoader即常说的类加载器，其功能是用于从Class文件加载所需的类，主要场景用于热部署、代码热替换等场景。 系统提供3种的类加载器：Bootstrap ClassLoader、Extension ClassLoader、Application ClassLoader</p>
<h3 id="1-1-Bootstrap-ClassLoader"><a href="#1-1-Bootstrap-ClassLoader" class="headerlink" title="1.1 Bootstrap ClassLoader"></a>1.1 Bootstrap ClassLoader</h3><p>启动类加载器，一般由C++实现，是虚拟机的一部分。该类加载器主要职责是将JAVA_HOME路径下的\lib目录中能被虚拟机识别的类库(比如rt.jar)加载到虚拟机内存中。Java程序无法直接引用该类加载器</p>
<h3 id="1-2-Extension-ClassLoader"><a href="#1-2-Extension-ClassLoader" class="headerlink" title="1.2 Extension ClassLoader"></a>1.2 Extension ClassLoader</h3><p>扩展类加载器，由Java实现，独立于虚拟机的外部。该类加载器主要职责将JAVA_HOME路径下的\lib\ext目录中的所有类库，开发者可直接使用扩展类加载器。 该加载器是由sun.misc.Launcher$ExtClassLoader实现。</p>
<h3 id="1-3-Application-ClassLoader"><a href="#1-3-Application-ClassLoader" class="headerlink" title="1.3 Application ClassLoader"></a>1.3 Application ClassLoader</h3><p>应用程序类加载器，该加载器是由sun.misc.Launcher$AppClassLoader实现，该类加载器负责加载用户类路径上所指定的类库。开发者可通过ClassLoader.getSystemClassLoader()方法直接获取，故又称为系统类加载器。当应用程序没有自定义类加载器时，默认采用该类加载器。</p>
<p>ClassLoader.java</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">public static ClassLoader getSystemClassLoader() &#123;</span><br><span class="line">    initSystemClassLoader(); &#x2F;&#x2F;初始化系统类加载器 【见下文】</span><br><span class="line">    if (scl &#x3D;&#x3D; null) &#123;</span><br><span class="line">        return null;</span><br><span class="line">    &#125;</span><br><span class="line">    SecurityManager sm &#x3D; System.getSecurityManager();</span><br><span class="line">    if (sm !&#x3D; null) &#123;</span><br><span class="line">        ClassLoader ccl &#x3D; getCallerClassLoader();</span><br><span class="line">        if (ccl !&#x3D; null &amp;&amp; ccl !&#x3D; scl &amp;&amp; !scl.isAncestor(ccl)) &#123;</span><br><span class="line">            sm.checkPermission(SecurityConstants.GET_CLASSLOADER_PERMISSION);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    return scl;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>系统类加载器初始化：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">private static synchronized void initSystemClassLoader() &#123;</span><br><span class="line">    if (!sclSet) &#123;</span><br><span class="line">        if (scl !&#x3D; null)</span><br><span class="line">            throw new IllegalStateException(&quot;recursive invocation&quot;);</span><br><span class="line">        sun.misc.Launcher l &#x3D; sun.misc.Launcher.getLauncher();</span><br><span class="line">        if (l !&#x3D; null) &#123;</span><br><span class="line">            Throwable oops &#x3D; null;</span><br><span class="line">            scl &#x3D; l.getClassLoader();</span><br><span class="line">            try &#123;</span><br><span class="line">                scl &#x3D; AccessController.doPrivileged(</span><br><span class="line">                    new SystemClassLoaderAction(scl));</span><br><span class="line">            &#125; catch (PrivilegedActionException pae) &#123;</span><br><span class="line">                oops &#x3D; pae.getCause();</span><br><span class="line">                if (oops instanceof InvocationTargetException) &#123;</span><br><span class="line">                    oops &#x3D; oops.getCause();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            if (oops !&#x3D; null) &#123;</span><br><span class="line">                if (oops instanceof Error) &#123;</span><br><span class="line">                    throw (Error) oops;</span><br><span class="line">                &#125; else &#123;</span><br><span class="line">                    throw new Error(oops);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        sclSet &#x3D; true;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="二、双亲委派模型"><a href="#二、双亲委派模型" class="headerlink" title="二、双亲委派模型"></a>二、双亲委派模型</h2><p>ClassLoader的双亲委派模型中，各个ClassLoader之间的关系是通过组合关系来复用父加载器。当一个ClassLoader收到来类加载的请求，首先把该请求委派该父类ClassLoader处理，当父类ClassLoader无法处理时，才由当前类ClassLoader来处理。对于每个ClassLoader这个方式，也就是父类的优先于子类处理类加载的请求，那么也就是说任何一个请求第一次处理的便是最顶层的Bootstrap ClassLoader(启动类加载器)。</p>
<p>类加载器的层级查找顺序依次为：启动类加载器，扩展类加载器，系统类加载器。系统类加载器是默认的应用程序类加载器。</p>
<p><img src="http://gityuan.com/images/jvm/classloader.png" alt="classloader"></p>
<p>这样的好处是不同层次的类加载器具有不同优先级，比如所有Java对象的超级父类java.lang.Object，位于rt.jar，无论哪个类加载器加载该类，最终都是由启动类加载器进行加载，保证安全。即使用户自己编写一个java.lang.Object类并放入程序中，虽能正常编译，但不会被加载运行，保证不会出现混乱。那么有人会继续追问，如果自己再自定义一个类加载器来加载自己定义的java.lang.Object类呢? 这样做也是不会成功的，虚拟机将会抛出一异常。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">protected Class&lt;?&gt; loadClass(String name, boolean resolve)</span><br><span class="line">    throws ClassNotFoundException</span><br><span class="line">&#123;</span><br><span class="line">    synchronized (getClassLoadingLock(name)) &#123;</span><br><span class="line">        &#x2F;&#x2F;检查该类是否已经加载过</span><br><span class="line">        Class c &#x3D; findLoadedClass(name);</span><br><span class="line">        if (c &#x3D;&#x3D; null) &#123;</span><br><span class="line">            &#x2F;&#x2F;如果该类没有加载，则进入该分支</span><br><span class="line">            long t0 &#x3D; System.nanoTime();</span><br><span class="line">            try &#123;</span><br><span class="line">                if (parent !&#x3D; null) &#123;</span><br><span class="line">                    &#x2F;&#x2F;当父类的加载器不为空，则通过父类的loadClass来加载该类</span><br><span class="line">                    c &#x3D; parent.loadClass(name, false);</span><br><span class="line">                &#125; else &#123;</span><br><span class="line">                    &#x2F;&#x2F;当父类的加载器为空，则调用启动类加载器来加载该类</span><br><span class="line">                    c &#x3D; findBootstrapClassOrNull(name);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; catch (ClassNotFoundException e) &#123;</span><br><span class="line">                &#x2F;&#x2F;非空父类的类加载器无法找到相应的类，则抛出异常</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            if (c &#x3D;&#x3D; null) &#123;</span><br><span class="line">                &#x2F;&#x2F;当父类加载器无法加载时，则调用findClass方法来加载该类</span><br><span class="line">                long t1 &#x3D; System.nanoTime();</span><br><span class="line">                c &#x3D; findClass(name); &#x2F;&#x2F;用户可通过覆写该方法，来自定义类加载器</span><br><span class="line"></span><br><span class="line">                &#x2F;&#x2F;用于统计类加载器相关的信息</span><br><span class="line">                sun.misc.PerfCounter.getParentDelegationTime().addTime(t1 - t0);</span><br><span class="line">                sun.misc.PerfCounter.getFindClassTime().addElapsedTimeFrom(t1);</span><br><span class="line">                sun.misc.PerfCounter.getFindClasses().increment();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        if (resolve) &#123;</span><br><span class="line">            &#x2F;&#x2F;对类进行link操作</span><br><span class="line">            resolveClass(c);</span><br><span class="line">        &#125;</span><br><span class="line">        return c;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>当开发者需要自定义类加载器时，可通过覆写loadClass()方法或者findClass()。</p>
<h2 id="三、自定义类加载器"><a href="#三、自定义类加载器" class="headerlink" title="三、自定义类加载器"></a>三、自定义类加载器</h2><p>每一个ClassLoader都拥有自己独立的类名称空间，类是由ClassLoader将其加载到Java虚拟机中，故类是由加载它的ClassLoader和该类本身一起确定其在Java 运行时环境的唯一性。故只有同一个ClassLoader加载的同一个类，才能算是Java 运行时环境中的相同的两个类。哪怕是来自同一个Class文件，即使被同一个虚拟机加载的两个类，只要ClassLoader不同，那么也属于不同的类。对于equals()、isinstanceof()等方法来判断对象的相等或所属关系都是需要基于同一个ClassLoader。</p>
<p>自定义类加载器示例：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">package com.yuanhh.classloader;</span><br><span class="line"></span><br><span class="line">import java.io.IOException;</span><br><span class="line">import java.io.InputStream;</span><br><span class="line"></span><br><span class="line">public class ClassLoadDemo&#123;</span><br><span class="line"></span><br><span class="line">    public static void main(String[] args) throws Exception &#123;</span><br><span class="line"></span><br><span class="line">        ClassLoader clazzLoader &#x3D; new ClassLoader() &#123;</span><br><span class="line">            @Override</span><br><span class="line">            public Class&lt;?&gt; loadClass(String name) throws ClassNotFoundException &#123;</span><br><span class="line">                try &#123;</span><br><span class="line">                    String clazzName &#x3D; name.substring(name.lastIndexOf(&quot;.&quot;) + 1) + &quot;.class&quot;;</span><br><span class="line"></span><br><span class="line">                    InputStream is &#x3D; getClass().getResourceAsStream(clazzName);</span><br><span class="line">                    if (is &#x3D;&#x3D; null) &#123;</span><br><span class="line">                        return super.loadClass(name);</span><br><span class="line">                    &#125;</span><br><span class="line">                    byte[] b &#x3D; new byte[is.available()];</span><br><span class="line">                    is.read(b);</span><br><span class="line">                    return defineClass(name, b, 0, b.length);</span><br><span class="line">                &#125; catch (IOException e) &#123;</span><br><span class="line">                    throw new ClassNotFoundException(name);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        String currentClass &#x3D; &quot;com.yuanhh.classloader.ClassLoadDemo&quot;;</span><br><span class="line">        Class&lt;?&gt; clazz &#x3D; clazzLoader.loadClass(currentClass);</span><br><span class="line">        Object obj &#x3D; clazz.newInstance();</span><br><span class="line"></span><br><span class="line">        System.out.println(obj.getClass());</span><br><span class="line">        System.out.println(obj instanceof com.yuanhh.classloader.ClassLoadDemo);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>上面代码的输出结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">class com.yuanhh.classloader.ClassLoadDemo</span><br><span class="line">false</span><br></pre></td></tr></table></figure>

<p>输出结果的第一行，可以看出这个对象的确是<code>com.yuanhh.classloader.ClassLoadDemo</code>实例化的对象；但第二句是false，这是由于代码中的obj是由用户自定义的类加载器clazzLoader来加载的，可通过obj.getClass().getClassLoader()获取该对象的类加载器为com.yuanhh.classloader.ClassLoadDemo$xxx，而虚拟机本身会由系统类加载器加载的类ClassLoadDemo，可通过ClassLoadDemo.class.getClassLoader()得其类加载器为sun.misc.Launcher$AppClassLoader@XXX。所以可得出结论：即使都是来自同一个Class文件，加载器不同，仍然是两个不同的类，所以返回值是false。</p>
<p>通过<code>Class.forName()</code>方法加载的类，采用的是系统类加载器。</p>
<h2 id="四、-经典应用场景"><a href="#四、-经典应用场景" class="headerlink" title="四、 经典应用场景"></a>四、 经典应用场景</h2><ul>
<li>Tomcat，类加载器架构，自己定义了多个类加载器，<ul>
<li>保证了同一个服务器的两个Web应用程序的Java类库隔离；</li>
<li>保证了同一个服务器的两个Web应用程序的Java类库又可以相互共享；比如多个Spring组织的应用程序不能共享，会造成资源浪费；</li>
<li>保证了服务器尽可能保证自身的安全不受不受部署Web应用程序影响；</li>
<li>支持JSP应用的服务器，大多需要支持热替换(HotSwap)功能。</li>
</ul>
</li>
<li>OSGi(Open Service GateWay Initiative)，是基于Java语言的动态模块化规范。已成为Java世界的“事实上”的模块化标准，最为熟悉的案例的Eclipse IDE。</li>
</ul>
<h2 id="五、手撕双亲委派"><a href="#五、手撕双亲委派" class="headerlink" title="五、手撕双亲委派"></a>五、手撕双亲委派</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line">package com.zhyen.test.class_loader;</span><br><span class="line"></span><br><span class="line">import com.zhyen.test.TestMain;</span><br><span class="line"></span><br><span class="line">public class ClassLoader &#123;</span><br><span class="line"></span><br><span class="line">    private ClassLoader parent;</span><br><span class="line">    private static ClassLoader classLoader;</span><br><span class="line"></span><br><span class="line">    public ClassLoader(ClassLoader parent) &#123;</span><br><span class="line">        this.parent &#x3D; parent;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public ClassLoader() &#123;</span><br><span class="line">        this(getSystemClassLoader());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private static ClassLoader getSystemClassLoader() &#123;</span><br><span class="line">        initSystemClassLoader();</span><br><span class="line">        if (classLoader &#x3D;&#x3D; null) &#123;</span><br><span class="line">            return null;</span><br><span class="line">        &#125;</span><br><span class="line">        return classLoader;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private static void initSystemClassLoader() &#123;</span><br><span class="line">        Launcher launcher &#x3D; Launcher.getLauncher();</span><br><span class="line">        if (launcher !&#x3D; null) &#123;</span><br><span class="line">            classLoader &#x3D; launcher.getClassLoader();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public String loadClass(String name) throws ClassNotFoundException &#123;</span><br><span class="line">        return loadClass(name, false);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private String loadClass(String name, boolean b) &#123;</span><br><span class="line">        TestMain.log(&quot;loadClass: &quot; + this.getClass().getSimpleName());</span><br><span class="line">        &#x2F;&#x2F;检查该类是否已经加载过</span><br><span class="line">        String loadedClass &#x3D; findLoadedClass(name);</span><br><span class="line">        if (loadedClass &#x3D;&#x3D; null) &#123;</span><br><span class="line">            if (parent !&#x3D; null) &#123;</span><br><span class="line">                &#x2F;&#x2F;当父类的加载器不为空，则通过父类的loadClass来加载该类</span><br><span class="line">                loadedClass &#x3D; parent.loadClass(name, false);</span><br><span class="line">            &#125; else &#123;</span><br><span class="line">                &#x2F;&#x2F;当父类的加载器为空，则调用启动类加载器来加载该类</span><br><span class="line">                loadedClass &#x3D; findBootstrapClassOrNull(name);</span><br><span class="line">            &#125;</span><br><span class="line">            if (loadedClass &#x3D;&#x3D; null) &#123;</span><br><span class="line">                loadedClass &#x3D; findClass(name); &#x2F;&#x2F;用户可通过覆写该方法，来自定义类加载器</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        return loadedClass;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public String findClass(String name) &#123;</span><br><span class="line">        if(this instanceof Launcher.AppClassLoader)&#123;</span><br><span class="line">            TestMain.log(&quot;findClass: 被&quot; + this.getClass().getSimpleName()+&quot;处理了&quot;);</span><br><span class="line">            return &quot;冯星.class&quot;;</span><br><span class="line">        &#125;</span><br><span class="line">        return null;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private String findBootstrapClassOrNull(String name) &#123;</span><br><span class="line">        TestMain.log(&quot;findBootstrapClassOrNull: Bootstrap无法处理&quot; + name + &quot;这个类，交给子类吧&quot;);</span><br><span class="line">        return null;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private String findLoadedClass(String name) &#123;</span><br><span class="line">        TestMain.log(&quot;findLoadedClass: 没有加载过&quot; + name + &quot;这个类,使用类加载器去加载&quot;);</span><br><span class="line">        return null;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">package com.zhyen.test.class_loader;</span><br><span class="line"></span><br><span class="line">public class Launcher &#123;</span><br><span class="line"></span><br><span class="line">    private static Launcher launcher &#x3D; new Launcher();</span><br><span class="line">    private ClassLoader loader;</span><br><span class="line"></span><br><span class="line">    public Launcher() &#123;</span><br><span class="line">        ExtClassLoader extClassLoader &#x3D; new ExtClassLoader();</span><br><span class="line">        loader &#x3D; new AppClassLoader(extClassLoader);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public static Launcher getLauncher() &#123;</span><br><span class="line">        return launcher;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public static class ExtClassLoader extends ClassLoader &#123;</span><br><span class="line"></span><br><span class="line">        public ExtClassLoader() &#123;</span><br><span class="line">            super(null);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public static class AppClassLoader extends ClassLoader &#123;</span><br><span class="line">        public AppClassLoader(ClassLoader parent) &#123;</span><br><span class="line">            super(parent);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public ClassLoader getClassLoader() &#123;</span><br><span class="line">        return this.loader;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">package com.zhyen.test;</span><br><span class="line"></span><br><span class="line">import com.zhyen.test.class_loader.ClassLoader;</span><br><span class="line"></span><br><span class="line">public class TestMain &#123;</span><br><span class="line"></span><br><span class="line">    public static void main(String[] arg) &#123;</span><br><span class="line">        testClassLoader();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private static void testClassLoader() &#123;</span><br><span class="line">        ClassLoader classLoader &#x3D; new ClassLoader();</span><br><span class="line">        try &#123;</span><br><span class="line">            String loadClass &#x3D; classLoader.loadClass(&quot;冯星&quot;);</span><br><span class="line">            log(&quot;最后的结果:&quot; + loadClass);</span><br><span class="line">        &#125; catch (ClassNotFoundException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public static void log(String msg) &#123;</span><br><span class="line">        System.out.println(msg);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">loadClass: ClassLoader</span><br><span class="line">findLoadedClass: 没有加载过冯星这个类,使用类加载器去加载</span><br><span class="line">loadClass: AppClassLoader</span><br><span class="line">findLoadedClass: 没有加载过冯星这个类,使用类加载器去加载</span><br><span class="line">loadClass: ExtClassLoader</span><br><span class="line">findLoadedClass: 没有加载过冯星这个类,使用类加载器去加载</span><br><span class="line">findBootstrapClassOrNull: Bootstrap无法处理冯星这个类，交给子类吧</span><br><span class="line">findClass: 被AppClassLoader处理了</span><br><span class="line">最后的结果:冯星.class</span><br></pre></td></tr></table></figure>


          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/06/05/Java/%E5%8F%8D%E5%B0%84/%E7%90%86%E8%A7%A3Java%E5%8F%8D%E5%B0%84%E6%9C%BA%E5%88%B6/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="冯星">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="冯星的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/06/05/Java/%E5%8F%8D%E5%B0%84/%E7%90%86%E8%A7%A3Java%E5%8F%8D%E5%B0%84%E6%9C%BA%E5%88%B6/" itemprop="url">理解Java反射机制</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-06-05T14:08:25+08:00">
                2020-06-05
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Java/" itemprop="url" rel="index">
                    <span itemprop="name">Java</span>
                  </a>
                </span>

                
                
                  , 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Java/%E5%8F%8D%E5%B0%84/" itemprop="url" rel="index">
                    <span itemprop="name">反射</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2020/06/05/Java/%E5%8F%8D%E5%B0%84/%E7%90%86%E8%A7%A3Java%E5%8F%8D%E5%B0%84%E6%9C%BA%E5%88%B6/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count valine-comment-count" data-xid="/2020/06/05/Java/%E5%8F%8D%E5%B0%84/%E7%90%86%E8%A7%A3Java%E5%8F%8D%E5%B0%84%E6%9C%BA%E5%88%B6/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <blockquote>
<p>对于Java使用者来说，反射机制可以说是不得不了解的重要技能之一</p>
</blockquote>
<h3 id="一、概述"><a href="#一、概述" class="headerlink" title="一、概述"></a>一、概述</h3><p>JAVA反射机制，可在运行态直接操作任意类或对象的所有属性和方法，主要有以下几个功能：</p>
<ul>
<li>在运行时获取任意对象所属的类</li>
<li>在运行时构造类的实例对象</li>
<li>在运行时获取或修改类/成员的属性</li>
<li>在运行时调用某个类/对象的方法</li>
<li>另外还可获取类的其他信息，比如描述修饰符、父类信息等</li>
</ul>
<p>针对动态语言，大致认同的一个定义是：“程序运行时，允许改变程序结构或变量类型，这种语言称为动态语言”。反射机制在运行时只能调用methods或改变fields内容，却无法修改程序结构或变量类型。从这个观点看，Perl，Python，Ruby是动态语言，C++，Java，C#不是动态语言。</p>
<h3 id="二、反射原理"><a href="#二、反射原理" class="headerlink" title="二、反射原理"></a>二、反射原理</h3><p>用于操作反射相关的主要有以下5个类：</p>
<ul>
<li>java.lang.Class： 代表类</li>
<li>java.lang.reflect.Constructor: 代表类的构造方法</li>
<li>java.lang.reflect.Field: 代表类的属性</li>
<li>java.lang.reflect.Method: 代表类的方法</li>
<li>java.lang.reflect.Modifier：代表类、方法、属性的描述修饰符。</li>
</ul>
<p>Constructor、Field、Method这三个类都继承AccessibleObject，该对象有一个非常重要的方法<code>setAccessible(boolean flag)</code>, 用于保证反射可调用非Public的属性与方法。Modifier是指描述修饰符，包含如下范围： public, protected, private, abstract, static, final, transient, volatile, synchronized, native, strictfp, interface。</p>
<h4 id="2-1-Constructor"><a href="#2-1-Constructor" class="headerlink" title="2.1 Constructor"></a>2.1 Constructor</h4><p>通过java.lang.reflect.Constructor来操作类的构造方法</p>
<table>
<thead>
<tr>
<th align="left">方法</th>
<th align="left">含义</th>
</tr>
</thead>
<tbody><tr>
<td align="left">getConstructors()</td>
<td align="left">获得类的所有public构造方法</td>
</tr>
<tr>
<td align="left">getDeclaredConstructors()</td>
<td align="left">获得类的所有构造方法</td>
</tr>
<tr>
<td align="left">getConstructor(Class[] parameterTypes)</td>
<td align="left">获得类的特定public构造方法</td>
</tr>
<tr>
<td align="left">getDeclaredConstructor(Class[] params)</td>
<td align="left">获取类的特定构造方法</td>
</tr>
</tbody></table>
<h4 id="2-2-Field"><a href="#2-2-Field" class="headerlink" title="2.2 Field"></a>2.2 Field</h4><p>通过java.lang.reflect.Field来获取和修改成员属性，其中getField和getDeclaredField的核心区别就是是否指定类型为public</p>
<table>
<thead>
<tr>
<th align="left">方法</th>
<th align="left">含义</th>
</tr>
</thead>
<tbody><tr>
<td align="left">getFields()</td>
<td align="left">获得类的所有public属性</td>
</tr>
<tr>
<td align="left">getDeclaredFields()</td>
<td align="left">获得类的所有属性</td>
</tr>
<tr>
<td align="left">getField(String name)</td>
<td align="left">获得类的特定public属性</td>
</tr>
<tr>
<td align="left">getDeclaredField(String name)</td>
<td align="left">获取类的特定属性</td>
</tr>
</tbody></table>
<h4 id="2-3-Method"><a href="#2-3-Method" class="headerlink" title="2.3 Method"></a>2.3 Method</h4><p>通过java.lang.reflect.Method来执行成员方法</p>
<table>
<thead>
<tr>
<th align="left">方法</th>
<th align="left">含义</th>
</tr>
</thead>
<tbody><tr>
<td align="left">getMethods()</td>
<td align="left">获得类的所有public成员方法</td>
</tr>
<tr>
<td align="left">getDeclaredMethods()</td>
<td align="left">获得类的所有成员方法</td>
</tr>
<tr>
<td align="left">getMethod(String name, Class[] parameterTypes)</td>
<td align="left">获得类的特定public成员方法</td>
</tr>
<tr>
<td align="left">getDeclaredMethod(String name, Class[] parameterTypes)</td>
<td align="left">获取类的特定成员方法</td>
</tr>
</tbody></table>
<h4 id="2-4-Class类的原理"><a href="#2-4-Class类的原理" class="headerlink" title="2.4 Class类的原理"></a>2.4 Class类的原理</h4><p>Java所有的类都是继承于类Object，其内声明了多个应该被所有Java类覆写的方法：hashCode()、equals()、clone()、toString()、notify()、wait()、getClass(）等，其中getClass返回的便是一个Class类的对象。Class类也同样是继承Object类，拥有相应的方法。</p>
<p>Java程序在运行时，运行时系统对每一个对象都有一项类型标识，用于记录对象所属的类。虚拟机使用运行时类型来选择相应方法去执行，保存所有对象类型信息的类便是Class类。Class类没有公共构造方法，Class对象是在加载类时由 Java 虚拟机以及通过调用ClassLoader的defineClass 方法自动构造的，因此不能显式地声明一个Class对象。</p>
<p>虚拟机为每种类型管理一个独一无二的Class对象。也就是说，每个类型都有一个Class对象。运行程序时，Java虚拟机(JVM)首先检查是否所要加载的类对应的Class对象是否已经加载。如果没有加载，JVM就会根据类名查找.class文件，并将其Class对象载入。</p>
<p>基本的 Java 类型（boolean、byte、char、short、int、long、float 和 double）和关键字 void 也都对应一个 Class 对象。 每个数组属于被映射为 Class 对象的一个类，所有具有相同元素类型和维数的数组都共享该 Class 对象。一般某个类的Class对象被载入内存，它就用来创建这个类的所有对象。</p>
<h3 id="三、反射实例"><a href="#三、反射实例" class="headerlink" title="三、反射实例"></a>三、反射实例</h3><p>对于正常方式来调用方法，往往只需要一行到两行代码，即可完成相应工作。而反射则显得比较繁琐，之所以繁琐仍会才用反射方式，是因为反射能干很多正常实例化对象的方式所无法做到的事。比如操作那些private的类、方法、属性，以及@hide标记过的类、方法、属性。</p>
<p>为了到达即能有反射的功效，同时调用方法简单易用，建议大家自己封装一个反射工具类ReflectUtils。（注：以下实例为了代码精简，忽略Exception以及异常处理逻辑。）</p>
<h4 id="3-1-创建对象"><a href="#3-1-创建对象" class="headerlink" title="3.1 创建对象"></a>3.1 创建对象</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//根据类名来获取类</span></span><br><span class="line">Class clazz = Class.forName(<span class="string">"java.lang.String"</span>);</span><br><span class="line"><span class="comment">//根据对象来获取类</span></span><br><span class="line">Class clazz = object.getClass();</span><br><span class="line"><span class="comment">//根据类来实例化对象</span></span><br><span class="line">Object obj = clazz.newInstance();</span><br><span class="line"></span><br><span class="line"><span class="comment">//获取无参的构造函数</span></span><br><span class="line">Constructor c = clazz.getConstructor(<span class="keyword">null</span>);</span><br><span class="line"><span class="comment">//获取参数为String,int的构造函数</span></span><br><span class="line">Constructor c = clazz.getConstructor(String<span class="class">.<span class="keyword">class</span>, <span class="title">int</span>.<span class="title">class</span>)</span>;</span><br><span class="line"><span class="comment">//用于调用私有构造方法</span></span><br><span class="line">c.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">Object obj = c.newInstance(<span class="string">"gityuan.com"</span>, <span class="number">2015</span>);</span><br></pre></td></tr></table></figure>

<h4 id="3-2-获取-修改属性"><a href="#3-2-获取-修改属性" class="headerlink" title="3.2 获取/修改属性"></a>3.2 获取/修改属性</h4><p>1) 获取对象的属性:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Object <span class="title">getField</span><span class="params">(Object object, String fieldName)</span> </span>&#123;</span><br><span class="line">    Class clazz = object.getClass();</span><br><span class="line">    Field field = clazz.getDeclaredField(fieldName);</span><br><span class="line">    field.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">    <span class="keyword">return</span> field.get(object)；</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>2) 修改对象的属性:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">boolean</span> <span class="title">setField</span><span class="params">(Object object, String fieldName, Object fieldValue)</span> </span>&#123;</span><br><span class="line">    Class clazz = object.getClass();</span><br><span class="line">    Field field = clazz.getDeclaredField(fieldName);</span><br><span class="line">    field.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">    <span class="keyword">return</span> field.set(object, fieldValue);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>3) 获取类的静态属性:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">public static Object getField(Class clazz, String fieldName) &#123;</span><br><span class="line">    Field field &#x3D; clazz.getDeclaredField(fieldName);</span><br><span class="line">    field.setAccessible(true);</span><br><span class="line">    return field.get(null)；</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>4) 修改类的静态属性:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">public static boolean setField(Class clazz, String fieldName, Object fieldValue) &#123;</span><br><span class="line">    Field field &#x3D; clazz.getDeclaredField(fieldName);</span><br><span class="line">    field.setAccessible(true);</span><br><span class="line">    return field.set(null, fieldValue);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="3-3-调用方法"><a href="#3-3-调用方法" class="headerlink" title="3.3 调用方法"></a>3.3 调用方法</h4><p>1) 调用对象方法</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Object <span class="title">invokeMethod</span><span class="params">(Object object, String methodName, Class[] argsType, Object... args)</span> </span>&#123;</span><br><span class="line">    Class clazz = object.getClass();</span><br><span class="line">    Method method = clazz.getDeclaredMethod(methodName, argsType);</span><br><span class="line">    <span class="keyword">return</span> method.invoke(object, args);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>2) 调用类的静态方法</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Object <span class="title">invokeMethod</span><span class="params">(Class clazz, String methodName, Class[] argsType, Object... args)</span> </span>&#123;</span><br><span class="line">    Method method = clazz.getDeclaredMethod(methodName, argsType);</span><br><span class="line">    method.setAccessible(<span class="keyword">true</span>);  </span><br><span class="line">    <span class="keyword">return</span> method.invoke(<span class="keyword">null</span>, args);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="3-4-调用内部类"><a href="#3-4-调用内部类" class="headerlink" title="3.4 调用内部类"></a>3.4 调用内部类</h4><p>假设com.reflect.Outer类，有一个内部类inner和静态内部类StaticInner。 那么静态内部类的构造函数为Outer$StaticInner(); 而普通内部类的构造函数为Outer$Inner(Outer outer)，多了一个final的Outer类型属性，即Outer$Inner.this$0，用于存储外部类的属性值，也就是说非static内部类保持了外部类的引用。</p>
<p>直接实例化内部类方法如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; 静态内部类</span><br><span class="line">Outer.StaticInner sInner &#x3D; new Outer.StaticInner();</span><br><span class="line">&#x2F;&#x2F; 非静态内部类</span><br><span class="line">Outer.Inner inner &#x3D; new Outer().new Inner();</span><br></pre></td></tr></table></figure>

<p>内部类的类名使用采用$符号，来连接外部类与内部类，格式为outer$Inner</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">String className = <span class="string">"com.reflect.Outer$Inner"</span>;</span><br><span class="line">Class.forName(className);</span><br></pre></td></tr></table></figure>

<p>除了格式了差异，关于内部类的属性和方法操作基本相似，下面以调用该静态类的静态方法为例</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Object <span class="title">invokeMethod</span><span class="params">(String methodName, Class[] argsType, Object... args)</span> </span>&#123;</span><br><span class="line">    Class clazz = Class.forName(“com.reflect.Outer$StaticInner<span class="string">");</span></span><br><span class="line"><span class="string">    Method method = clazz.getDeclaredMethod(methodName, argsType);</span></span><br><span class="line"><span class="string">    method.setAccessible(true);  </span></span><br><span class="line"><span class="string">    return method.invoke(null, args);</span></span><br><span class="line"><span class="string">&#125;</span></span><br></pre></td></tr></table></figure>

<h3 id="四、小节"><a href="#四、小节" class="headerlink" title="四、小节"></a>四、小节</h3><p>反射机制为解耦合提供了保障机制，也为在运行时动态修改属性和调用方法提供的可能性。在Android的源码中，我们会发现有很多被”@hide”标记的类，它的作用是使这个类或方法在生成SDK时不可见。那么应用程序便不可以直接调用。而反射机制可调用@hide标记的类或方法，如入无人之地，畅通无阻。不过从Android P开始就不允许调用@hide方法，会在虚拟机层面拦截直接抛出异常。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/06/05/grep%E5%92%8Cfind%E5%91%BD%E4%BB%A4%E7%94%A8%E6%B3%95/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="冯星">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="冯星的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/06/05/grep%E5%92%8Cfind%E5%91%BD%E4%BB%A4%E7%94%A8%E6%B3%95/" itemprop="url">grep和find命令用法</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-06-05T13:26:17+08:00">
                2020-06-05
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2020/06/05/grep%E5%92%8Cfind%E5%91%BD%E4%BB%A4%E7%94%A8%E6%B3%95/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count valine-comment-count" data-xid="/2020/06/05/grep%E5%92%8Cfind%E5%91%BD%E4%BB%A4%E7%94%A8%E6%B3%95/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <blockquote>
<p>Linux下搜索文件内容常用grep，搜索文件信息使用find</p>
</blockquote>
<h2 id="一、-grep"><a href="#一、-grep" class="headerlink" title="一、 grep"></a>一、 grep</h2><p>搜索文本的命令</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">命令格式: grep [options]... pattern [file]...</span><br><span class="line">命令格式: grep 查找规则... 正则表达式 查看文件</span><br></pre></td></tr></table></figure>

<h3 id="1-1-查找规则"><a href="#1-1-查找规则" class="headerlink" title="1.1 查找规则"></a>1.1 查找规则</h3><table>
<thead>
<tr>
<th align="left">options</th>
<th align="left">解释</th>
</tr>
</thead>
<tbody><tr>
<td align="left">-i</td>
<td align="left">不区分大 小写(只适用于单字符)</td>
</tr>
<tr>
<td align="left">-r</td>
<td align="left">遍历匹配</td>
</tr>
<tr>
<td align="left">-v</td>
<td align="left">显示不包含匹配文本的所有行</td>
</tr>
<tr>
<td align="left">-s</td>
<td align="left">不显示不存在或无匹配文本的错误信息</td>
</tr>
<tr>
<td align="left">-E</td>
<td align="left">可用于同时匹配多关键词</td>
</tr>
<tr>
<td align="left">-w</td>
<td align="left">整字匹配</td>
</tr>
<tr>
<td align="left">-l</td>
<td align="left">查询多文件时只输出包含匹配字符的文件名</td>
</tr>
<tr>
<td align="left">-c</td>
<td align="left">只输出匹配行的计数</td>
</tr>
<tr>
<td align="left">-n</td>
<td align="left">显示匹配行及行号</td>
</tr>
<tr>
<td align="left">-h</td>
<td align="left">查询多文件时不显示文件名</td>
</tr>
</tbody></table>
<h3 id="1-2-正则表达式"><a href="#1-2-正则表达式" class="headerlink" title="1.2 正则表达式"></a>1.2 正则表达式</h3><p>pattern正则表达式主要参数：</p>
<ul>
<li>\： 忽略正则表达式中特殊字符的原有含义。</li>
<li>^：匹配正则表达式的开始行。</li>
<li>$: 匹配正则表达式的结束行。</li>
<li>&lt;：从匹配正则表达 式的行开始。</li>
<li>&gt;：到匹配正则表达式的行结束。</li>
<li>[ ]：单个字符，如[A]即A符合要求 。</li>
<li>[ - ]：范围，如[A-Z]，即A、B、C一直到Z都符合要求 。</li>
<li>. ：所有的单个字符。</li>
<li>* ：有字符，长度可以为0.</li>
</ul>
<h3 id="1-3-实例"><a href="#1-3-实例" class="headerlink" title="1.3 实例"></a>1.3 实例</h3><ul>
<li><p>忽略大小写搜索</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">grep -i &quot;androiD&quot;  logcat.txt   &#x2F;&#x2F;从logcat.txt文件中，搜索包含android的文本行，不区分大小写</span><br></pre></td></tr></table></figure>
</li>
<li><p>遍历搜索，且不显示无匹配信息</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">grep -rs &quot;android&quot; .   &#x2F;&#x2F;从当前目录下，遍历所有的文件，搜索包含android的文本行</span><br></pre></td></tr></table></figure>
</li>
<li><p>整字匹配搜索</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">grep -w &quot;android&quot; logcat.txt  &#x2F;&#x2F;从logcat.txt文件中，搜索包含单词android的文本行</span><br><span class="line">grep -w &quot;android | ios&quot; logcat.txt  &#x2F;&#x2F;从logcat.txt文件中，搜索包含单词android或者ios的文本行</span><br></pre></td></tr></table></figure>
</li>
<li><p>只列出文件名</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">grep -l &quot;android&quot; .</span><br></pre></td></tr></table></figure>
</li>
<li><p>统计字符出现次数</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">grep -c &quot;android&quot; .</span><br></pre></td></tr></table></figure>
</li>
<li><p>显示字符出现所在行</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">grep -n &quot;android“ .</span><br></pre></td></tr></table></figure>
</li>
<li><p>显示多条件匹配</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">grep -E &quot;android|linux“ .</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h2 id="二、-find"><a href="#二、-find" class="headerlink" title="二、 find"></a>二、 find</h2><p>搜索文件的命令</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">命令格式  find pathname -options [ actions]</span><br><span class="line">命令格式  find 查找目录  -查找规则 [执行操作]</span><br></pre></td></tr></table></figure>

<h3 id="2-1-查找目录"><a href="#2-1-查找目录" class="headerlink" title="2.1 查找目录"></a>2.1 查找目录</h3><p>(1) 如果不写，默认为当前路径； (2) 支持多个路径，目录直接用空格间隔；</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">find . -name demo</span><br></pre></td></tr></table></figure>

<h4 id="2-1-1-查看某目录文件个数"><a href="#2-1-1-查看某目录文件个数" class="headerlink" title="2.1.1 查看某目录文件个数"></a>2.1.1 查看某目录文件个数</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">find . -type f  |wc -l</span><br></pre></td></tr></table></figure>

<h3 id="2-2-查找规则"><a href="#2-2-查找规则" class="headerlink" title="2.2 查找规则"></a>2.2 查找规则</h3><h4 id="2-2-1-根据文件名-name"><a href="#2-2-1-根据文件名-name" class="headerlink" title="2.2.1 根据文件名(name)"></a>2.2.1 根据文件名(name)</h4><p><code>-name</code> //根据文件名查找，区分大小写 <code>-iname</code> //根据文件名查找，不区分大小写</p>
<p>通配符说明： (1)* 匹配任意的若干个字符 (2)? 匹配任意的单个字符 (3)[] 匹配括号内的任意一个字符</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">find &#x2F;data -name dalvi*</span><br><span class="line">find &#x2F;data -name dalvik?cache</span><br><span class="line">find &#x2F;data -name dalvik-cach[abe]</span><br></pre></td></tr></table></figure>

<h4 id="2-2-2-根据文件类型-type"><a href="#2-2-2-根据文件类型-type" class="headerlink" title="2.2.2 根据文件类型(type)"></a>2.2.2 根据文件类型(type)</h4><ul>
<li>f 普通文件</li>
<li>d 目录文件</li>
<li>l 链接文件</li>
<li>b 块设备文件</li>
<li>c 字符设备文件</li>
<li>p 管道文件</li>
<li>s socket文件</li>
</ul>
<p>例如：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">find -type f &#x2F;&#x2F;查看文件类型</span><br></pre></td></tr></table></figure>

<h4 id="2-2-3-根据目录深度-depth"><a href="#2-2-3-根据目录深度-depth" class="headerlink" title="2.2.3 根据目录深度(depth)"></a>2.2.3 根据目录深度(depth)</h4><ul>
<li>-maxdepth n: 查找最大深度为n</li>
<li>-mindepth m: 查找最小深度为m</li>
</ul>
<h4 id="2-2-4-根据文件大小-size"><a href="#2-2-4-根据文件大小-size" class="headerlink" title="2.2.4 根据文件大小(size)"></a>2.2.4 根据文件大小(size)</h4><p>单位：c(小写), k(小写), M(大写), G(大写)</p>
<p>-size +10M: 查找大于10M的文件 -size -2k: 查找小于2k的文件 -empty: 查找大小为0的文件或空目录</p>
<h4 id="2-2-5-根据文件权限-perm"><a href="#2-2-5-根据文件权限-perm" class="headerlink" title="2.2.5 根据文件权限(perm)"></a>2.2.5 根据文件权限(perm)</h4><p>例如：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">find -perm 777 &#x2F;&#x2F;查找权限为777的文件</span><br></pre></td></tr></table></figure>

<h4 id="2-2-6-根据文件所属用户和组"><a href="#2-2-6-根据文件所属用户和组" class="headerlink" title="2.2.6 根据文件所属用户和组"></a>2.2.6 根据文件所属用户和组</h4><ul>
<li>-user: 根据属主来查找文件</li>
<li>-group: 根据属组来查找文件</li>
</ul>
<h4 id="2-2-7-根据uid和gid"><a href="#2-2-7-根据uid和gid" class="headerlink" title="2.2.7 根据uid和gid"></a>2.2.7 根据uid和gid</h4><ul>
<li>-uid 500: 查找uid是500 的文件</li>
<li>-gid 1000: 查找gid是1000的文件</li>
</ul>
<h4 id="2-2-8-根据时间"><a href="#2-2-8-根据时间" class="headerlink" title="2.2.8 根据时间"></a>2.2.8 根据时间</h4><p>可以通过<code>stat</code>命令来查看文件的时间，下列是按照文件的各种时间来查找文件：</p>
<ul>
<li>-mtime -n +n: 根据更改(modify)时间，-n指n天以内，+n指n天以前</li>
<li>-atime -n +n: 根据访问(access)时间，-n指n天以内，+n指n天以前</li>
<li>-ctime -n +n: 根据创建(create)时间，-n指n天以内，+n指n天以前</li>
<li>-mmin -n +n: 根据更改(modify)时间，-n指n分钟以内，+n指n分钟以前</li>
<li>-amin -n +n: 根据访问(access)时间，-n指n分钟以内，+n指n分钟以前</li>
<li>-cmin -n +n: 根据创建(create)时间，-n指n分钟以内，+n指n分钟以前</li>
</ul>
<h4 id="2-2-9-多条件连接"><a href="#2-2-9-多条件连接" class="headerlink" title="2.2.9 多条件连接"></a>2.2.9 多条件连接</h4><ul>
<li>-a: 两个条件同时满足（and）</li>
<li>-o: 两个条件满足其一（or）</li>
<li>-not: 对条件取反（not）</li>
</ul>
<p>例如，查找当前路径下，以a开头，并排除掉以b结尾的文件或文件夹：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">find -name a* -not -name *b</span><br></pre></td></tr></table></figure>

<h3 id="2-3-执行操作"><a href="#2-3-执行操作" class="headerlink" title="2.3 执行操作"></a>2.3 执行操作</h3><ul>
<li><p><code>-print</code> 匹配文件输出到标准输出，默认操作</p>
</li>
<li><p><code>-ls</code> 查找到的结果，以ls方式显示</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">find -name app -ls</span><br></pre></td></tr></table></figure>
</li>
<li><p><code>-ok [command]</code> 查找完成后，执行command执行，询问执行</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">find -name app -ok cat &#123;&#125; \;   &#x2F;&#x2F;注意：&#123;&#125;前后有空格</span><br></pre></td></tr></table></figure>
</li>
<li><p><code>-exec [command]</code> 查找完成后，执行command执行，直接执行</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">find -name app  -exec ls &#123;&#125; \;</span><br></pre></td></tr></table></figure></li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/06/05/Android/%E5%BC%80%E5%8F%91/Android%E4%B8%AD%E7%9A%84dp%E3%80%81sp%E4%B8%8Epx%E6%8D%A2%E7%AE%97%E5%85%B3%E7%B3%BB/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="冯星">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="冯星的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/06/05/Android/%E5%BC%80%E5%8F%91/Android%E4%B8%AD%E7%9A%84dp%E3%80%81sp%E4%B8%8Epx%E6%8D%A2%E7%AE%97%E5%85%B3%E7%B3%BB/" itemprop="url">Android中的dp、sp与px换算关系</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-06-05T13:17:54+08:00">
                2020-06-05
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Android/" itemprop="url" rel="index">
                    <span itemprop="name">Android</span>
                  </a>
                </span>

                
                
                  , 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Android/%E5%BC%80%E5%8F%91/" itemprop="url" rel="index">
                    <span itemprop="name">开发</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2020/06/05/Android/%E5%BC%80%E5%8F%91/Android%E4%B8%AD%E7%9A%84dp%E3%80%81sp%E4%B8%8Epx%E6%8D%A2%E7%AE%97%E5%85%B3%E7%B3%BB/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count valine-comment-count" data-xid="/2020/06/05/Android/%E5%BC%80%E5%8F%91/Android%E4%B8%AD%E7%9A%84dp%E3%80%81sp%E4%B8%8Epx%E6%8D%A2%E7%AE%97%E5%85%B3%E7%B3%BB/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="1-基本概念"><a href="#1-基本概念" class="headerlink" title="1. 基本概念"></a>1. 基本概念</h3><ul>
<li><strong>px：</strong> 像素（pixel），设备上的物理像素点。</li>
<li><strong>dp：</strong>跟dip是同一个概念，与屏幕物理像素点无关，而是基于屏幕密度抽象单位，被称作“设备独立像素”,会随着屏幕的密度进行自动的大小调整。</li>
<li><strong>sp：</strong> 专用于文字大小的设置，可根据字体大小首选项进行缩放。</li>
<li><strong>inch：</strong> 英寸，1英寸 = 2.54厘米。</li>
<li><strong>dpi：</strong> 屏幕像素密度, 单位英寸上像素点的数量。</li>
<li><strong>分辨率：</strong> 是指横纵方向上的像素点数，单位是px。一般是纵向像素*横向像素，比如1920 * 1080</li>
<li><strong>屏幕尺寸：</strong> 屏幕对角线的长度，单位是inch。比如我们平时常说的5寸手机，是指手机屏幕的对角线长度为5英寸。</li>
</ul>
<hr>
<h3 id="2-换算关系"><a href="#2-换算关系" class="headerlink" title="2. 换算关系"></a>2. 换算关系</h3><p><strong>以下常见尺寸表：</strong></p>
<table>
<thead>
<tr>
<th align="left">level</th>
<th align="left">dpi</th>
<th align="left">scale</th>
<th align="left">resolution</th>
</tr>
</thead>
<tbody><tr>
<td align="left">ldpi</td>
<td align="left">120</td>
<td align="left">0.75</td>
<td align="left">320*240</td>
</tr>
<tr>
<td align="left">mdpi</td>
<td align="left">160</td>
<td align="left">1</td>
<td align="left">480*320</td>
</tr>
<tr>
<td align="left">hdpi</td>
<td align="left">240</td>
<td align="left">1.5</td>
<td align="left">800*480</td>
</tr>
<tr>
<td align="left">xhdpi</td>
<td align="left">320</td>
<td align="left">2</td>
<td align="left">1280*720</td>
</tr>
<tr>
<td align="left">xxhdpi</td>
<td align="left">480</td>
<td align="left">3</td>
<td align="left">1920*1080</td>
</tr>
<tr>
<td align="left">xxxhdpi</td>
<td align="left">640</td>
<td align="left">4</td>
<td align="left">2560*1440</td>
</tr>
</tbody></table>
<p><strong>说明：</strong></p>
<ul>
<li>google官方用的词是approximately，比如ldpi是值近似等于120dpi；</li>
<li>分辨率列只是比较有代表性的而已，但设备的dpi，还需要根据相应的设备尺寸来计算。同一分辨率，设备尺寸越大，那么dpi就越小，单位英寸上像素点越稀疏。</li>
</ul>
<p><strong>换算关系：</strong></p>
<p>android.util.TypedValue类提供了一个函数，提供所有单位与px的换算关系。</p>
<ul>
<li><strong>dpi如何计算</strong>？ dpi，英文全称dot per inch，是指每英寸上的像素点个数。 计算公式：dpi=√(X²+Y²)/Z (其中 X：纵向的像素个数；Y：横向的像素个数；Z：屏幕尺寸)</li>
<li><strong>scale是如何计算的</strong>？ 定义以160dpi作为基准，当前设备的dpi/160dpi = scale值。也就是当设备的dpi为160时1dp=1px.</li>
<li><strong>dp与px如何转换</strong>？ 计算公式：pxs = dps * (dpi/160)， 比如：320dpi的设备，10dp转换为px为 10 *（320/160）px = 20 px，即320dpi下10dp=20px.</li>
<li><strong>1dp到底等于多长呢</strong>？ 假设设备的dpi=320, 是指320px对应的长度为1英寸, 那么1px=1/320 英寸。再根据前面的公式， 1dp = （320/160） px = 2px。故1dp对应的长度为2 * (1/320)英寸，即1/160英寸。 同理，假设设备的dpi =N，那么1dp = (N/160) px = (N/160) * (1/N) inch = 1/160 inch，再加上前面提到的近似，可以得出结论为<strong>1dp约等于1/160英寸</strong>。</li>
</ul>
<h3 id="3-UI适配"><a href="#3-UI适配" class="headerlink" title="3. UI适配"></a>3. UI适配</h3><ul>
<li>layout中，最好采用wap_content, fill_parent，dp，可保证在屏幕上有合适的大小;</li>
<li>像素单位使用dp, 文字单位使用sp；</li>
<li>程序代码中不要出现具体的px;</li>
<li>图片应多使用.9.png；</li>
<li>使用百分比布局；</li>
<li>查看不同分辨率的设备市场占有率，分析出需要支持的设备分辨率：<ul>
<li><a href="http://screensiz.es/" target="_blank" rel="noopener">http://screensiz.es</a></li>
<li><a href="http://opensignal.com/reports/2015/08/android-fragmentation" target="_blank" rel="noopener">http://opensignal.com/reports/2015/08/android-fragmentation</a></li>
</ul>
</li>
<li>对不同大小的屏幕提供不同的layout；</li>
<li>对不同密度的屏幕提供不同的图片；</li>
</ul>
<hr>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/06/05/Android/%E5%BC%80%E5%8F%91/Android%E5%BC%80%E5%8F%91%E8%A7%84%E8%8C%83/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="冯星">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="冯星的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/06/05/Android/%E5%BC%80%E5%8F%91/Android%E5%BC%80%E5%8F%91%E8%A7%84%E8%8C%83/" itemprop="url">Android开发规范</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-06-05T13:13:15+08:00">
                2020-06-05
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Android/" itemprop="url" rel="index">
                    <span itemprop="name">Android</span>
                  </a>
                </span>

                
                
                  , 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Android/%E5%BC%80%E5%8F%91/" itemprop="url" rel="index">
                    <span itemprop="name">开发</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2020/06/05/Android/%E5%BC%80%E5%8F%91/Android%E5%BC%80%E5%8F%91%E8%A7%84%E8%8C%83/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count valine-comment-count" data-xid="/2020/06/05/Android/%E5%BC%80%E5%8F%91/Android%E5%BC%80%E5%8F%91%E8%A7%84%E8%8C%83/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <blockquote>
<p>Google官方Java代码风格参考规范<a href="http://google-styleguide.googlecode.com/svn/trunk/javaguide.html" target="_blank" rel="noopener">链接</a>， 中文翻译参考版<a href="http://hawstein.com/posts/google-java-style.html" target="_blank" rel="noopener">链接</a>。</p>
</blockquote>
<h2 id="命名规范"><a href="#命名规范" class="headerlink" title="命名规范"></a>命名规范</h2><h3 id="1-包命名"><a href="#1-包命名" class="headerlink" title="1. 包命名"></a>1. 包命名</h3><p>规则：包名全部小写，采用反域名命名规则，一级包名是顶级域名，通常为com, edu, gov, net, org等，二级包名，通过为公司名或部门名或者个人名，三级包名通常为项目名，四级包名为模块名或者层级名。以下是从层级包名来划分android项目中采用的包划分结构</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">com.domain.xxx.activity  &#x2F;&#x2F;用户界面中所有的Activity类</span><br><span class="line">com.domain.xxx.fragment  &#x2F;&#x2F;界面中所有的Fragment类</span><br><span class="line">com.domain.xxx.adapter   &#x2F;&#x2F;界面中所有的Adapter类（适配器类）</span><br><span class="line">com.domain.xxx.view      &#x2F;&#x2F;自定义的View类</span><br><span class="line">com.domain.xxx.service   &#x2F;&#x2F;后台Service类</span><br><span class="line">com.domain.xxx.util      &#x2F;&#x2F;项目中常用的公共工具类（网络, IO, 日志等）</span><br><span class="line">com.domain.xxx.bean      &#x2F;&#x2F;实体模型类</span><br><span class="line">com.domain.xxx.db        &#x2F;&#x2F;数据库操作相关的类</span><br><span class="line">com.domain.xxx.config    &#x2F;&#x2F;所有的配置相关的类</span><br><span class="line">com.domain.xxx.api       &#x2F;&#x2F;网络api接口相关de 类</span><br></pre></td></tr></table></figure>

<h3 id="2-类命名"><a href="#2-类命名" class="headerlink" title="2. 类命名"></a>2. 类命名</h3><p>规则：采用<strong>大驼峰式</strong>命名法，首字母大写，尽量避免缩写，除非该缩写是众所周知的，比如HTML，URL,如果类名称包含单词缩写，则单词缩写的每个字母均应大写。以下列举的是android中几种最为常用的类的命名。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">class LoginActivity;     &#x2F;&#x2F;activity类</span><br><span class="line">class DiscoverFragment;  &#x2F;&#x2F;fragment类</span><br><span class="line">class AnalysisService;   &#x2F;&#x2F;service类</span><br><span class="line">class WakeupRankAdapter; &#x2F;&#x2F;adapter类</span><br><span class="line">class StringUtils;       &#x2F;&#x2F;工具类</span><br><span class="line">class UserBean;          &#x2F;&#x2F;模型类</span><br><span class="line">class ApiImpl;           &#x2F;&#x2F;接口实现类</span><br></pre></td></tr></table></figure>

<h3 id="3-接口命名"><a href="#3-接口命名" class="headerlink" title="3. 接口命名"></a>3. 接口命名</h3><p>规则：命名规则与类命名一样采用<strong>大驼峰式</strong>命名法，首字母大写，多以able, ible, er结尾</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">interface Comparable;</span><br><span class="line">interface Accessible;</span><br><span class="line">interface OnClickListener;</span><br></pre></td></tr></table></figure>

<h3 id="4-方法"><a href="#4-方法" class="headerlink" title="4. 方法"></a>4. 方法</h3><p>规则：采用<strong>小驼峰</strong>命名法，首字母小写，方法名采用动词或动名词结构。方法的命名应该与方法的真正行为具有对应关系，下面给出一些方法名的动词前缀标示的建议。</p>
<table>
<thead>
<tr>
<th align="left">方法名</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody><tr>
<td align="left">getXX()</td>
<td align="left">获取某个属性的返回值</td>
</tr>
<tr>
<td align="left">setXX()</td>
<td align="left">设置某个属性值</td>
</tr>
<tr>
<td align="left">initXX()</td>
<td align="left">初始化方法，如初始化布局initView()</td>
</tr>
<tr>
<td align="left">isXX()</td>
<td align="left">判断是否true的方法；</td>
</tr>
<tr>
<td align="left">checkXX()</td>
<td align="left">与isXX意义等价</td>
</tr>
<tr>
<td align="left">processXX()</td>
<td align="left">处理数据</td>
</tr>
<tr>
<td align="left">updateXX()</td>
<td align="left">更新数据</td>
</tr>
<tr>
<td align="left">saveXX()</td>
<td align="left">保存数据</td>
</tr>
<tr>
<td align="left">addXX()</td>
<td align="left">添加数据</td>
</tr>
<tr>
<td align="left">deleteXX()</td>
<td align="left">删除数据</td>
</tr>
<tr>
<td align="left">resetXX()</td>
<td align="left">重置数据</td>
</tr>
<tr>
<td align="left">clearXX()</td>
<td align="left">清除数据</td>
</tr>
<tr>
<td align="left">removeXX()</td>
<td align="left">移除数据或者视图等，如removeView();</td>
</tr>
<tr>
<td align="left">drawXX()</td>
<td align="left">绘制数据或者视图</td>
</tr>
</tbody></table>
<h3 id="5-变量"><a href="#5-变量" class="headerlink" title="5. 变量"></a>5. 变量</h3><p>规则：采用<strong>小驼峰</strong>命名法，首字母小写。变量名应简短且能描述其用途，尽量避免拼音，无意义地缩写。除非是临时变量，否则不建议使用单个字符的变量名，如i, j, k。对于变量命名，还有一种风格是google的以字母m为前缀（m为member缩写），在android 源码中随处可见。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">private int userName;  &#x2F;&#x2F;java的一般性风格</span><br><span class="line">private int mUserName; &#x2F;&#x2F;google的成员变量风格，m为member的缩写</span><br></pre></td></tr></table></figure>

<h3 id="6-常量"><a href="#6-常量" class="headerlink" title="6. 常量"></a>6. 常量</h3><p>规则：常量使用<strong>全大写字母</strong>加下划线的方式命名。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">public static final int TAG&#x3D; &quot;tag&quot;;</span><br><span class="line">public static final int START_CLASS_NOT_FOUND &#x3D; -2;</span><br></pre></td></tr></table></figure>

<hr>
<p><strong>下面介绍的与android关系更加紧密：</strong></p>
<h3 id="7-控件变量名"><a href="#7-控件变量名" class="headerlink" title="7. 控件变量名"></a>7. 控件变量名</h3><p>规则：首先需要满足第5条变量的规则， 模式：逻辑名 + view缩写</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Button sendNewsBtn;</span><br><span class="line">TextView passwordTxt;</span><br></pre></td></tr></table></figure>

<h3 id="8-控件ID"><a href="#8-控件ID" class="headerlink" title="8. 控件ID"></a>8. 控件ID</h3><p>规则：view缩写_模块名_逻辑名</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">android:id&#x3D;&quot;@+id&#x2F;btn_news_send&quot;  &#x2F;&#x2F;样例</span><br></pre></td></tr></table></figure>

<p>view缩写如下：</p>
<table>
<thead>
<tr>
<th align="left">View</th>
<th align="left">缩写</th>
</tr>
</thead>
<tbody><tr>
<td align="left">TextView</td>
<td align="left">txt</td>
</tr>
<tr>
<td align="left">EditText</td>
<td align="left">edit</td>
</tr>
<tr>
<td align="left">Button</td>
<td align="left">btn</td>
</tr>
<tr>
<td align="left">ImageButton</td>
<td align="left">ibtn</td>
</tr>
<tr>
<td align="left">ImageView</td>
<td align="left">img</td>
</tr>
<tr>
<td align="left">ListView</td>
<td align="left">lv</td>
</tr>
<tr>
<td align="left">RadioGroup</td>
<td align="left">rgroup</td>
</tr>
<tr>
<td align="left">RadioButton</td>
<td align="left">rbtn</td>
</tr>
<tr>
<td align="left">ProgressBar</td>
<td align="left">rbar</td>
</tr>
<tr>
<td align="left">SeekBar</td>
<td align="left">seek</td>
</tr>
<tr>
<td align="left">CheckBox</td>
<td align="left">cb</td>
</tr>
<tr>
<td align="left">Spinner</td>
<td align="left">spinner</td>
</tr>
<tr>
<td align="left">TableLayout</td>
<td align="left">table</td>
</tr>
<tr>
<td align="left">TableRow</td>
<td align="left">row</td>
</tr>
<tr>
<td align="left">LinearLayout</td>
<td align="left">ll</td>
</tr>
<tr>
<td align="left">RelativeLayout</td>
<td align="left">rl</td>
</tr>
<tr>
<td align="left">ScrollView</td>
<td align="left">scroll</td>
</tr>
<tr>
<td align="left">SearchView</td>
<td align="left">search</td>
</tr>
<tr>
<td align="left">TabHost</td>
<td align="left">thost</td>
</tr>
<tr>
<td align="left">TabWidget</td>
<td align="left">twidget</td>
</tr>
</tbody></table>
<h3 id="9-资源文件名"><a href="#9-资源文件名" class="headerlink" title="9. 资源文件名"></a>9. 资源文件名</h3><h4 id="9-1-layout的文件命名"><a href="#9-1-layout的文件命名" class="headerlink" title="9.1 layout的文件命名"></a>9.1 layout的文件命名</h4><p>规则：全部小写，采用下划线命名法。layout文件命名：组件类型<em>{模块</em>}功能.xml</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">activity_news_title.xml &#x2F;&#x2F;样例</span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th align="left">命名规范</th>
<th align="left">组件类型</th>
</tr>
</thead>
<tbody><tr>
<td align="left">activity_{模块_}功能</td>
<td align="left">Activity命名格式</td>
</tr>
<tr>
<td align="left">fragment_{模块_}功能</td>
<td align="left">Fragment命名格式</td>
</tr>
<tr>
<td align="left">dialog_{模块_}功能</td>
<td align="left">Dialog命名格式</td>
</tr>
<tr>
<td align="left">popup_{模块_}功能</td>
<td align="left">PopupWindow命名格式</td>
</tr>
<tr>
<td align="left">item_list_{模块_}功能</td>
<td align="left">ListView的item命名格式</td>
</tr>
<tr>
<td align="left">item_grid_{模块_}功能</td>
<td align="left">GridView的item命名格式</td>
</tr>
</tbody></table>
<h4 id="9-2-drawable的文件命名"><a href="#9-2-drawable的文件命名" class="headerlink" title="9.2 drawable的文件命名"></a>9.2 drawable的文件命名</h4><p>模式：前缀{_控件}{_范围}{_后缀}，控件、范围、后缀可选</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bg_login_pressed.png &#x2F;&#x2F;样例</span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th align="left">drawable</th>
<th align="left">命名细则</th>
</tr>
</thead>
<tbody><tr>
<td align="left">图标类</td>
<td align="left">添加ic前缀</td>
</tr>
<tr>
<td align="left">背景类</td>
<td align="left">添加bg前缀</td>
</tr>
<tr>
<td align="left">分隔类</td>
<td align="left">添加div前缀</td>
</tr>
<tr>
<td align="left">默认类</td>
<td align="left">添加def前缀</td>
</tr>
<tr>
<td align="left">区分状态时，默认状态</td>
<td align="left">添加normal后缀</td>
</tr>
<tr>
<td align="left">区分状态时，按下时的状态</td>
<td align="left">添加pressed后缀</td>
</tr>
<tr>
<td align="left">区分状态时，选中时的状态</td>
<td align="left">添加selected后缀</td>
</tr>
<tr>
<td align="left">区分状态时，不可用时的状态</td>
<td align="left">添加disable后缀</td>
</tr>
<tr>
<td align="left">多种状态的</td>
<td align="left">添加selector后缀</td>
</tr>
</tbody></table>
<h4 id="9-3-动画的文件命名"><a href="#9-3-动画的文件命名" class="headerlink" title="9.3 动画的文件命名"></a>9.3 动画的文件命名</h4><p>规则：{范围_}动画类型_动画方向。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">login_fade_in.xml &#x2F;&#x2F;样例</span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th align="left">动画命名</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody><tr>
<td align="left">fade_in</td>
<td align="left">淡入</td>
</tr>
<tr>
<td align="left">fade_out</td>
<td align="left">淡出</td>
</tr>
<tr>
<td align="left">push_down_in</td>
<td align="left">从下方推入</td>
</tr>
<tr>
<td align="left">push_down_out</td>
<td align="left">从下方推出</td>
</tr>
<tr>
<td align="left">slide_in_from_top</td>
<td align="left">从头部滑动进入</td>
</tr>
<tr>
<td align="left">zoom_enter</td>
<td align="left">变形进入</td>
</tr>
<tr>
<td align="left">shrink_to_middle</td>
<td align="left">中间缩小</td>
</tr>
</tbody></table>
<h3 id="10-资源内的name命名"><a href="#10-资源内的name命名" class="headerlink" title="10. 资源内的name命名"></a>10. 资源内的name命名</h3><h4 id="10-1-strings-xml"><a href="#10-1-strings-xml" class="headerlink" title="10.1 strings.xml"></a>10.1 strings.xml</h4><p>模式：activity名<em>{范围</em>}逻辑名</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;string name&#x3D;&quot;login_username&quot;&gt;用户名&lt;&#x2F;string&gt; &#x2F;&#x2F;样例</span><br></pre></td></tr></table></figure>

<h4 id="10-2-colors-xml"><a href="#10-2-colors-xml" class="headerlink" title="10.2 colors.xml"></a>10.2 colors.xml</h4><p>模式：前缀{_控件}{_范围}{_后缀}， 控件、范围、后缀可选，</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;color name&#x3D;&quot;bg_login&quot;&gt;#FFFFFF&lt;&#x2F;color&gt; &#x2F;&#x2F;样例</span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th align="left">colors</th>
<th align="left">命名细则</th>
</tr>
</thead>
<tbody><tr>
<td align="left">背景颜色</td>
<td align="left">添加bg前缀</td>
</tr>
<tr>
<td align="left">文本颜色</td>
<td align="left">添加text前缀</td>
</tr>
<tr>
<td align="left">分割线颜色</td>
<td align="left">添加div前缀</td>
</tr>
<tr>
<td align="left">区分状态时，默认状态的颜色</td>
<td align="left">添加normal后缀</td>
</tr>
<tr>
<td align="left">区分状态时，按下时的颜色</td>
<td align="left">添加pressed后缀</td>
</tr>
<tr>
<td align="left">区分状态时，选中时的颜色</td>
<td align="left">添加selected后缀</td>
</tr>
<tr>
<td align="left">区分状态时，不可用时的颜色</td>
<td align="left">添加disable后缀</td>
</tr>
</tbody></table>
<hr>
<h2 id="代码风格"><a href="#代码风格" class="headerlink" title="代码风格"></a>代码风格</h2><h3 id="原则"><a href="#原则" class="headerlink" title="原则"></a>原则</h3><ul>
<li><p>不要直接忽略Exceptions</p>
<p>例如下面的示例，永远不要这样做，无法预测未来可能的变化</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">void setServerPort(String value) &#123;</span><br><span class="line">    try &#123;</span><br><span class="line">        serverPort &#x3D; Integer.parseInt(value);</span><br><span class="line">    &#125; catch (NumberFormatException e) &#123; &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>正确的做法应该如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">void setServerPort(String value) throws ConfigurationException &#123;</span><br><span class="line">    try &#123;</span><br><span class="line">        serverPort &#x3D; Integer.parseInt(value);</span><br><span class="line">    &#125; catch (NumberFormatException e) &#123;</span><br><span class="line">        throw new ConfigurationException(&quot;Port &quot; + value + &quot; is not valid.&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>import采用完全限定名</p>
<p>不提倡：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">import foo.*;</span><br></pre></td></tr></table></figure>

<p>正确做法：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">import foo.Bar;</span><br></pre></td></tr></table></figure>
</li>
<li><p>括号风格：</p>
<p>不提倡：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">if (condition)</span><br><span class="line">    body();</span><br></pre></td></tr></table></figure>

<p>正确做法：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">if (condition) &#123;</span><br><span class="line">    body();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>使用空格来缩进</p>
<p>使用4个空格缩进来代表块，而绝不使用tab键； 使用8个空格来代表行包裹，包括函数调用。</p>
</li>
</ul>
<h3 id="注释"><a href="#注释" class="headerlink" title="注释"></a>注释</h3><ul>
<li><p>1.类注释，每个类完成后应该有作者姓名和联系方式的注释，对自己的代码负责</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;** * 作者: gityuan * 时间: 13-12-20 19：25 * 描述: 用户登录 * 联系方式: gityuan@gmail.com *&#x2F;</span><br><span class="line">public class Login&#123;</span><br><span class="line">        ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>2.方法注释，每一个成员方法（包括自定义成员方法、覆盖方法、属性方法）的方法头都必须做方法头注释</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;* * 方法名： * 功 能： * 参 数： * 返回值：无 *&#x2F;</span><br></pre></td></tr></table></figure>
</li>
<li><p>3.快注释</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">private class MessageObserver extends ContentObserver &#123;</span><br><span class="line">    public MessageObserver() &#123;</span><br><span class="line">        super(mainHandler);</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    public void onChange(boolean hasChanged) &#123;</span><br><span class="line">     &#x2F;&#x2F; 发送更新UI的消息</span><br><span class="line">     mHandler.sendMessage(mHandler.obtainMessage(0x2));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>4.资源文件注释</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--红色 --&gt;</span><br><span class="line">&lt;color name&#x3D;&quot;red&quot;&gt;#FF0000&lt;&#x2F;color&gt;</span><br><span class="line">&lt;!--深蓝色 --&gt;</span><br><span class="line">&lt;color name&#x3D;&quot;dark_blue&quot;&gt;#0079FF&lt;&#x2F;color&gt;</span><br></pre></td></tr></table></figure></li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/06/05/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-%E5%BC%80%E7%AF%87/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="冯星">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="冯星的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/06/05/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-%E5%BC%80%E7%AF%87/" itemprop="url">设计模式-开篇</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-06-05T12:58:49+08:00">
                2020-06-05
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/" itemprop="url" rel="index">
                    <span itemprop="name">设计模式</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2020/06/05/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-%E5%BC%80%E7%AF%87/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count valine-comment-count" data-xid="/2020/06/05/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-%E5%BC%80%E7%AF%87/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="一、设计模式"><a href="#一、设计模式" class="headerlink" title="一、设计模式"></a>一、设计模式</h2><h3 id="1-1-六大设计原则"><a href="#1-1-六大设计原则" class="headerlink" title="1.1 六大设计原则"></a>1.1 六大设计原则</h3><ol>
<li>单一职责原则(SRP)：一个类只负责一个职责，不要存在多个导致类变更的原因；</li>
<li>接口隔离原则(ISP)：客户端不应该依赖它不需要的接口，多用组合,少用继承</li>
<li>依赖倒置原则(DIP)： 提高灵活性,高层不依赖低层,两个都应该依赖于抽象</li>
<li>里氏替换原则(LSP)：子类必须能够替换他们的基类</li>
<li>迪米特法则(LOD)：类间解耦，类之间联系尽可能少</li>
<li>开闭原则(OCP)： 扩展开放,修改封闭</li>
</ol>
<p>总结：类单一，类间解耦，接口隔离，子类和子接口可替换，依赖抽象，开闭</p>
<h3 id="1-2-设计模式总纲"><a href="#1-2-设计模式总纲" class="headerlink" title="1.2 设计模式总纲"></a>1.2 设计模式总纲</h3><p>设计模式主要分三个类型: 创建型、结构型和行为型 (总计23种)</p>
<table>
<thead>
<tr>
<th align="left">创建型</th>
<th align="left">结构型</th>
<th align="left">行为型</th>
</tr>
</thead>
<tbody><tr>
<td align="left">单例模式</td>
<td align="left">代理模式</td>
<td align="left">观察者模式</td>
</tr>
<tr>
<td align="left">抽象工厂</td>
<td align="left">适配器模式</td>
<td align="left">迭代器模式</td>
</tr>
<tr>
<td align="left">工厂方法</td>
<td align="left">组合模式</td>
<td align="left">职责链模式</td>
</tr>
<tr>
<td align="left">建造模式</td>
<td align="left">外观模式</td>
<td align="left">模板方法</td>
</tr>
<tr>
<td align="left">原型模式</td>
<td align="left">装饰模式</td>
<td align="left">中介者模式</td>
</tr>
<tr>
<td align="left"></td>
<td align="left">桥模式</td>
<td align="left">策略模式</td>
</tr>
<tr>
<td align="left"></td>
<td align="left">享元模式</td>
<td align="left">命令模式</td>
</tr>
<tr>
<td align="left"></td>
<td align="left"></td>
<td align="left">状态模式</td>
</tr>
<tr>
<td align="left"></td>
<td align="left"></td>
<td align="left">访问者模式</td>
</tr>
<tr>
<td align="left"></td>
<td align="left"></td>
<td align="left">解释器模式</td>
</tr>
<tr>
<td align="left"></td>
<td align="left"></td>
<td align="left">备忘录模式</td>
</tr>
</tbody></table>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/">&lt;i class&#x3D;&quot;fa fa-angle-left&quot;&gt;&lt;&#x2F;i&gt;</a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><span class="space">&hellip;</span><a class="page-number" href="/page/11/">11</a><a class="extend next" rel="next" href="/page/3/">&lt;i class&#x3D;&quot;fa fa-angle-right&quot;&gt;&lt;&#x2F;i&gt;</a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">冯星</p>
              <p class="site-description motion-element" itemprop="description">人生就像是一个马尔可夫链，你的未来取决于你当下正在做的事，而无关于过去做完的事</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/%7C%7Carchive">
              
                  <span class="site-state-item-count">102</span>
                  <span class="site-state-item-name">posts</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">32</span>
                  <span class="site-state-item-name">categories</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                
                  <span class="site-state-item-count">52</span>
                  <span class="site-state-item-name">tags</span>
                
              </div>
            

          </nav>

          

          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">冯星</span>

  
</div>


  <div class="powered-by">Powered by <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a></div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Muse</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  










  <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
  <script src="//unpkg.com/valine/dist/Valine.min.js"></script>
  
  <script type="text/javascript">
    var GUEST = ['nick','mail','link'];
    var guest = 'nick,mail,link';
    guest = guest.split(',').filter(item=>{
      return GUEST.indexOf(item)>-1;
    });
    new Valine({
        el: '#comments' ,
        verify: false,
        notify: false,
        appId: 'bbc85MrQ0qhACWJxhCKrJoAj-gzGzoHsz',
        appKey: 'fWH5REKFSsGT4TKe1lWt1ke4',
        placeholder: 'Just go go',
        avatar:'mm',
        guest_info:guest,
        pageSize:'10' || 10,
    });
  </script>



  





  

  

  

  
  

  

  

  

</body>
</html>
